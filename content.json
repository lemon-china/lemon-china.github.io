{"meta":{"title":"Wei Echo","subtitle":"é«˜æ•ˆç¨³å®š Â· ç®€æ´æ˜“ç”¨ Â· çµæ´»æ‰©å±•","description":"è‡´åŠ›äºä¸­å°å‹æŠ€æœ¯å›¢é˜Ÿé«˜æ•ˆç¨³å®šçš„å¼€å‘æ¡†æ¶ï¼Œå…¨åŠ›æ‰“é€ ç®€æ´æ˜“ç”¨ã€çµæ´»æ‰©å±•çš„æŠ€æœ¯å›¢é˜Ÿè§£å†³æ–¹æ¡ˆ","author":"Wei Echo","url":"https://github.com/weiecho","root":"/"},"pages":[{"title":"åˆ†ç±»","date":"2019-09-07T06:11:44.000Z","updated":"2019-09-07T07:02:14.062Z","comments":true,"path":"categories/index.html","permalink":"https://github.com/weiecho/categories/index.html","excerpt":"","text":""},{"title":"archives","date":"2019-09-07T02:43:41.000Z","updated":"2019-09-07T07:37:44.969Z","comments":true,"path":"archives/index.html","permalink":"https://github.com/weiecho/archives/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2019-09-07T06:20:06.000Z","updated":"2019-09-07T07:02:07.740Z","comments":true,"path":"tags/index.html","permalink":"https://github.com/weiecho/tags/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2019-09-07T03:53:31.000Z","updated":"2019-09-07T13:19:13.083Z","comments":false,"path":"links/index.html","permalink":"https://github.com/weiecho/links/index.html","excerpt":"","text":"æŸ´ä¼™äºŒç»´ç å¹³å°æŸ´ä¼™äºŒç»´ç äº‘å¹³å°ï¼Œæ±‡èšå…¨å›½100ä¸‡ç²¾å“å¾®ä¿¡å°ç¨‹åºã€å¾®ä¿¡ç¾¤äºŒç»´ç ã€å¾®ä¿¡çº¢åŒ…ç¾¤ã€é™Œé™Œã€QQã€ä¸ªäººå·ã€ç¾¤ç»„åŠå…¬ä¼—å·ç­‰äºŒç»´ç å‘å¸ƒæ¨å¹¿ï¼Œä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªå®‰å…¨ã€é è°±çš„äº’è”ç½‘åº”ç”¨å¯¼èˆªå•†åº—å’Œå•†åŠ¡åˆä½œæ¨å¹¿å¹³å°ã€‚ é˜¿é‡Œäº‘è®¡ç®—å¹³å°é˜¿é‡Œäº‘æ˜¯é˜¿é‡Œå·´å·´é›†å›¢æ——ä¸‹å…¬å¸ï¼Œæ˜¯å…¨çƒé¢†å…ˆçš„äº‘è®¡ç®—åŠäººå·¥æ™ºèƒ½ç§‘æŠ€å…¬å¸ã€‚æä¾›äº‘æœåŠ¡å™¨ã€äº‘æ•°æ®åº“ã€äº‘å®‰å…¨ã€ä¼ä¸šåº”ç”¨ç­‰äº‘è®¡ç®—æœåŠ¡ï¼Œä»¥åŠå¤§æ•°æ®ã€äººå·¥æ™ºèƒ½è§£å†³æ–¹æ¡ˆï¼Œç²¾å‡†å®šåˆ¶åŸºäºåœºæ™¯çš„è¡Œä¸šè§£å†³æ–¹æ¡ˆã€‚ å¾®ä¿¡å…¬ä¼—å¹³å°å¾®ä¿¡å…¬ä¼—å¹³å°ï¼Œç»™ä¸ªäººã€ä¼ä¸šå’Œç»„ç»‡æä¾›ä¸šåŠ¡æœåŠ¡ä¸ç”¨æˆ·ç®¡ç†èƒ½åŠ›çš„å…¨æ–°æœåŠ¡å¹³å°ã€‚ èäº‘äº’è”ç½‘é€šä¿¡äº‘æœåŠ¡å•†èäº‘æ˜¯å®‰å…¨ã€å¯é çš„å…¨çƒäº’è”ç½‘é€šä¿¡äº‘æœåŠ¡å•†ï¼Œå‘å¼€å‘è€…å’Œä¼ä¸šæä¾›å³æ—¶é€šè®¯å’Œå®æ—¶éŸ³è§†é¢‘é€šä¿¡äº‘æœåŠ¡ã€‚èäº‘å¯æä¾›å¤šç§éƒ¨ç½²æ¨¡å¼ï¼šå…¬æœ‰äº‘ã€ç§æœ‰äº‘åŠæ··åˆäº‘ï¼ŒæœåŠ¡è¦†ç›–å…¨çƒæ‰€æœ‰å›½å®¶åŠåœ°åŒºã€‚å·²æœ‰25ä¸‡å¼€å‘è€…å’Œä¸Šåƒå®¶ä¼ä¸šç”¨æˆ·é€šè¿‡èäº‘å®ç°äº†åœºæ™¯åŒ–æ²Ÿé€šã€‚ å‹ç›Ÿæ•°æ®æ™ºèƒ½æœåŠ¡å•†å‹ç›Ÿæ˜¯å›½å†…é¢†å…ˆçš„ç¬¬ä¸‰æ–¹å…¨åŸŸæ•°æ®æ™ºèƒ½æœåŠ¡å•†ã€‚ä¸“æ³¨ä¸ºäº’è”ç½‘ä¼ä¸šæä¾›ä¸€ç«™å¼æ•°æ®åˆ†æè¿è¥æœåŠ¡è¿‘10å¹´ã€‚ä¸ºå¼€å‘è€…æä¾›æ›´çµæ´»ã€æ›´æ™ºèƒ½ã€æ›´ä¸“ä¸šçš„æ•°æ®é‡‡é›†ã€åˆ†æã€ç®¡ç†åŠŸèƒ½ï¼ŒAIèµ‹èƒ½ä¸šåŠ¡å¢é•¿ã€‚"}],"posts":[{"title":"lemon-echoæ¨¡å—åˆ’åˆ†åŸåˆ™","slug":"doc_1115","date":"2020-07-09T02:55:12.000Z","updated":"2020-07-09T02:54:35.902Z","comments":true,"path":"2020/07/09/doc_1115/","link":"","permalink":"https://github.com/weiecho/2020/07/09/doc_1115/","excerpt":"","text":"é«˜æ•ˆç¨³å®š Â· ç®€æ´æ˜“ç”¨ Â· çµæ´»æ‰©å±•é¡¹ç›®åœ°å€ï¼šlemon-echoå¾®æœåŠ¡æ¶æ„ 1ã€é¡¹ç›®ä¸šåŠ¡æ¨¡å—åˆ’åˆ†åŸåˆ™ï¼šé«˜å†…èšã€ä½è€¦åˆã€å¯å¤ç”¨ã€å¯æ‰©å±•ã€å¯ç»´æŠ¤ã€‚ 2ã€æ ¹æ®å…·ä½“çš„ä¸šåŠ¡å­ç±»å‹ã€æ“ä½œç±»å‹ç­‰å†åˆ†ä¸ºå­ä¸šåŠ¡æ¨¡å—ï¼Œå‚è€ƒä¸šåŠ¡éƒ¨é—¨ã€ä¸šåŠ¡ç±»å‹ã€æœåŠ¡å¯¹è±¡ç­‰ä¾æ®åˆ†ä¸ºå„å¤§ä¸šåŠ¡æ¨¡å—ã€‚ 3ã€æ–°å¢éœ€æ±‚è‹¥ä¸åŸä¸šåŠ¡æ¨¡å—å…³è”ä¸å¤§ï¼Œæˆ–è¾ƒå°‘è°ƒç”¨å…³ç³»ï¼Œåˆ™å¯å®šä¹‰ä¸ºæ–°çš„å­ä¸šåŠ¡æ¨¡å—ã€‚ 4ã€è®©ç¨‹åºæ¨¡å—å•å…ƒçš„èŒè´£å•ä¸€ï¼Œå¯ä»¥ä½¿ä½ åœ¨ç¼–å†™è¿™æ®µç¨‹åºæ—¶å…³æ³¨æ›´å°‘çš„ä¸œè¥¿ï¼Œä»è€Œé™ä½éš¾åº¦ï¼Œå‡å°‘å‡ºé”™ã€‚ 5ã€å…ˆä¸šåŠ¡åæŠ€æœ¯ï¼Œå…ˆé€»è¾‘åç‰©ç†ï¼ŒæœåŠ¡çš„ç¨³å®šæ€§ä¼˜å…ˆï¼Œé€šè¿‡æ‹†åˆ†è§£è€¦ 6ã€å°½é‡é¿å…äº‹åŠ¡ï¼Œé€‚å½“é‡‡ç”¨å¼‚æ­¥è§£è€¦ï¼Œé€‚å½“ä½¿ç”¨ç¼“å­˜","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://github.com/weiecho/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84/"},{"name":"lemon-echo","slug":"lemon-echo","permalink":"https://github.com/weiecho/tags/lemon-echo/"}]},{"title":"lemon-echoå¾®æœåŠ¡æ¶æ„è¯´æ˜","slug":"doc_1114","date":"2020-07-07T03:16:35.000Z","updated":"2020-07-09T02:53:24.144Z","comments":true,"path":"2020/07/07/doc_1114/","link":"","permalink":"https://github.com/weiecho/2020/07/07/doc_1114/","excerpt":"","text":"é«˜æ•ˆç¨³å®š Â· ç®€æ´æ˜“ç”¨ Â· çµæ´»æ‰©å±•é¡¹ç›®åœ°å€ï¼šlemon-echoå¾®æœåŠ¡æ¶æ„ weiechoå¾®æœåŠ¡æ¶æ„æ˜¯åŸºäºspringcloud + consulçš„å¾®æœåŠ¡æ¡†æ¶è®¾è®¡ä½“ç³»ï¼Œä»¥äººå‘˜ã€æ—¶æ•ˆã€æˆæœ¬ã€å“è´¨ä¸ºåŸºç¡€è®¾è®¡æ€è·¯ï¼Œæåº¦é€‚ç”¨äºå°ä¸­å‹å¼€å‘è®¾è®¡å›¢é˜Ÿï¼Œå¯é€šè¿‡ç®€å•è°ƒæ•´æ‰©å±•æ”¯æŒä¸­å¤§å‹å¼€å‘è®¾è®¡å›¢é˜Ÿã€‚æ¡†æ¶è®¾è®¡è¿‡ç¨‹ä¸­æ•´åˆå®é™…é¡¹ç›®ç»éªŒï¼Œåˆ©ç”¨æ¥å£åŒ–ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æ¨¡å—åŒ–ã€æœåŠ¡åŒ–ã€å¼‚æ­¥åŒ–ç­‰æŠ€æœ¯æ–¹æ¡ˆä¿éšœæœåŠ¡ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚ æ ¹æ®äº’è”ç½‘äº§å“å¤šå¹´ç»éªŒåˆ†æï¼Œæˆ‘ä»¬çš„äº§å“æ— è®ºä»ä»»ä½•è§’åº¦ä¸ºåˆ‡å…¥ç‚¹ï¼Œæœ€ç»ˆéƒ½å¸Œæœ›å®Œæˆç”¨æˆ·æ”¯ä»˜-æœåŠ¡çš„é—­ç¯æ€ç»´ï¼Œåœ¨weiechoçš„æ¶æ„ä½“ç³»è®¾è®¡æ—¶æœŸç›´æ¥å°†ç”¨æˆ·ã€å¸æˆ·ã€å•†å“ã€è®¢å•ã€äº¤æ˜“ã€æ¶ˆæ¯ä½œä¸ºåŠŸèƒ½æ¶æ„çš„åŸºç¡€æ¨¡å—ä½“ç³»ï¼Œä»è€Œç»“åˆå®é™…é¡¹ç›®ä½“ç³»å®Œæˆæ•´ä½“å¾®æœåŠ¡ä½“ç³»æ­å»ºï¼Œä»¥ååŠ©å›¢é˜Ÿå¿«é€Ÿé›†æˆå®Œå–„çš„å¼€å‘ç»“æ„ä½“ç³»ã€‚ ä¾æ‰˜åŠŸèƒ½é¢„ä»£å…¥æ¨¡å¼çš„å®Œå–„æ¶æ„ä½“ç³»æ€æƒ³ï¼Œåç»­åŠŸèƒ½å¼€å‘ä»…éœ€å¯¹ç›¸åº”ä¸šåŠ¡é€»è¾‘è¿›è¡Œéƒ¨åˆ†è°ƒæ•´ã€å¢åŠ å¯¹åº”çš„æœåŠ¡æ¨¡å—ï¼ˆå¦‚IMã€èŠå¤©å®¤ç­‰ï¼‰ï¼Œåˆ©ç”¨ç±»ä¼¼äºŒæ¬¡å¼€å‘æ–¹å¼æå¤§é™ä½å¼€å‘å›¢é˜Ÿçš„æŠ€æœ¯å£å’ï¼Œé™ä½å¾®æœåŠ¡å¼€å‘åŠæ²»ç†éš¾åº¦ï¼Œç»“åˆä»£ç å¿«é€Ÿç”Ÿæˆå™¨å¯ä»¥åœ¨10åˆ†é’Ÿå†…å®Œæˆç®€å•åŠŸèƒ½å¼€å‘ï¼Œéå¸¸å¿«å‘è¿­ä»£å¼€å‘çš„æŠ€æœ¯å›¢é˜Ÿï¼Œå°¤å…¶é€‚ç”¨äº50äººä»¥ä¸‹çš„æŠ€æœ¯å¼€å‘å›¢é˜Ÿã€‚ è§„åˆ’æ¶æ„è¯´æ˜weiechoæ¶æ„è€ƒè™‘å¤šè®¾å¤‡ã€å¤šåº”ç”¨åœºæ™¯ï¼Œä»åº”ç”¨å…¥å£åŒºåˆ†äº†å„ç±»åº”ç”¨å…¥å£çš„æ§åˆ¶å’Œç®¡ç†ï¼Œåœ¨åŠŸèƒ½æ–¹é¢åˆ†ä¸ºåº”ç”¨å…¥å£ã€æœåŠ¡ç½‘å…³ã€æ ¸å¿ƒæœåŠ¡ã€å…¬å…±æ¨¡å—ã€é£æ§æ¨¡å—ã€è¿è¥ç®¡ç†åå°ã€æ•°æ®æ”¯æŒç­‰æ¨¡å—ã€‚ åº”ç”¨å…¥å£åº”ç”¨å…¥å£å¯ä»¥æ¥å—APPã€WEBã€å°ç¨‹åºã€Aåº”ç”¨ã€Båº”ç”¨ã€å¤–éƒ¨åº”ç”¨ç­‰åº”ç”¨æ¥å…¥ï¼Œåˆ©ç”¨æœåŠ¡çš„é¡¹ç›®ç®¡ç†åŠŸèƒ½å¯ä»¥å®ç°æ— é™æ‰©å±•çš„åº”ç”¨æ¥å…¥æ–¹å¼ï¼Œä»è€Œè¾¾åˆ°ç±»ä¸­å°çš„æœåŠ¡æ¶æ„ä½“ç³»ã€‚ æœåŠ¡ç½‘å…³æœåŠ¡ç½‘å…³ä¸»è¦è€ƒè™‘å®‰å…¨ã€æµæ§ã€é£æ§ç­‰é£é™©å› ç´ ï¼Œæ¥å…¥å‚æ•°éªŒè¯ã€èº«ä»½éªŒè¯ã€è·¯ç”±ç­–ç•¥ã€æµæ§ç­–ç•¥ã€é£æ§éªŒè¯ç­‰å®‰å…¨æ¨¡å—ï¼Œä¿éšœæ•´ä½“æœåŠ¡å®‰å…¨ç¨³å®šè¿è¡Œã€‚ æ ¸å¿ƒæœåŠ¡æ ¸å¿ƒæœåŠ¡ä¸ºé¡¹ç›®ä¸»è¦ä¸šåŠ¡æœåŠ¡ï¼Œç›®å‰è§„åˆ’åˆ†ä¸ºèšåˆæœåŠ¡ã€ç”¨æˆ·æœåŠ¡ã€å¸æˆ·æœåŠ¡ã€å•†å“æœåŠ¡ã€è®¢å•æœåŠ¡ã€äº¤æ˜“æœåŠ¡ã€å¯¹è´¦æœåŠ¡ã€æ¸…ç®—æœåŠ¡ã€æ¶ˆæ¯æœåŠ¡ã€æˆæƒæœåŠ¡ã€è¥é”€æœåŠ¡ã€å”®åæœåŠ¡ç­‰ã€‚å¸‚åœºè¿è¥éœ€æ±‚å¯ä»¥å¢åŠ æ¨å¹¿æœåŠ¡ã€å¹¿å‘ŠæœåŠ¡ï¼Œå³æ—¶æ²Ÿé€šç±»éœ€æ±‚å¯ä»¥æ‰©å±•IMæœåŠ¡ï¼Œç›´æ’­ç±»éœ€æ±‚å¯ä»¥æ‰©å±•ç›´æ’­æœåŠ¡ï¼Œæ‰“èµæœåŠ¡ç­‰ã€‚ å…¬å…±æ¨¡å—å…¬å…±æ¨¡å—ä½œä¸ºä¸šåŠ¡çš„æ”¯æŒæœåŠ¡ï¼Œä¸»è¦åŒ…å«æˆæƒæœåŠ¡ã€æŠ¥è­¦æœåŠ¡ã€æ¶ˆæ¯æœåŠ¡ã€å•å·ç”Ÿæˆå™¨ã€æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€å®šæ—¶ä»»åŠ¡ã€åˆ†å¸ƒå¼é”ã€åˆ†åº“åˆ†è¡¨æ¨¡å—ï¼ŒæœåŠ¡æˆç†Ÿåå¯é€æ­¥è€ƒè™‘æ¥å…¥ç”Ÿç‰©è¯†åˆ«ã€å†…å®¹è¯†åˆ«ã€æ•°æ®æœåŠ¡ç­‰æ¨¡å—ã€‚ é£æ§æ¨¡å—é£æ§æ¨¡å—ä¸ºæœåŠ¡å®‰å…¨ç­‰æ ¸å¿ƒé¢†åŸŸï¼ŒåŒ…å«å®‰å…¨è®¤è¯ã€èµ„è´¨å®¡æŸ¥ã€ç”¨æˆ·åˆ†çº§ã€é»‘ç™½åå•ã€é£é™©é¢„è­¦ã€é£é™©å¤„ç½®ã€æ”¯ä»˜é£é™©ã€ä¿¡ç”¨é£é™©ã€å¾ä¿¡ç›¸å…³ç­‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å®Œå–„è¯¥æ¨¡å—å†…å®¹ä¿éšœæ•´ä½“æœåŠ¡ç­‰å®‰å…¨æ€§ã€‚ è¿è¥ç®¡ç†åå°è¿è¥ç®¡ç†åå°ä¸ºç®¡ç†æ•´ä¸ªæœåŠ¡çš„å…¥å£ï¼Œé€šè¿‡ç²¾ç¡®çš„æƒé™ç®¡æ§åˆ†é…ç”¨æˆ·æ˜¯ä½¿ç”¨åŠŸèƒ½ï¼Œå¯¹ç³»ç»Ÿç”¨æˆ·ã€å¸æˆ·ã€è®¢å•ã€äº¤æ˜“ã€å¯¹è´¦ã€æŠ•è¯‰ç­‰ä¿¡æ¯çš„æŸ¥çœ‹å’Œç»´æŠ¤æ“ä½œã€‚ æ•°æ®æ”¯æŒæ•°æ®æ”¯æŒåˆ†ä¸ºå†…éƒ¨æ•°æ®æ”¯æŒå’Œä¸‰æ–¹æ”¯æŒï¼Œå…¶ä¸­å†…éƒ¨æ•°æ®æ”¯æŒåŒ…å«mysqlã€redisã€rabbit mqã€promethesã€elkã€innerdbç­‰ï¼Œä¸‰æ–¹æ”¯æŒåŒ…å«çŸ­ä¿¡æœåŠ¡ã€æ¶ˆæ¯æœåŠ¡ã€OSSæ–‡ä»¶å­˜å‚¨ã€æ”¯ä»˜é€šé“ã€å®åè®¤è¯ã€ç”Ÿç‰©æ£€æµ‹ç­‰åŠŸèƒ½ã€‚ éƒ¨ç½²æ¶æ„è¯´æ˜ç”¨æˆ·è®¿é—®APPã€WEBã€H5é¡µé¢é€šè¿‡LBSç®—æ³•è°ƒç”¨åˆ°æœ€ä½³çš„nginxæœåŠ¡å™¨ï¼Œnginxé€šè¿‡è§„åˆ™è½¬å‘è°ƒç”¨åˆ°æŒ‡å®šçš„æœåŠ¡æˆ–æœåŠ¡ç½‘å…³ï¼Œgatwayç»è¿‡é‰´æƒã€é£æ§ç­‰å®‰å…¨æ ¡éªŒåé€šè¿‡consulæ³¨å†Œä¸­å¿ƒLBè·¯ç”±åˆ°æŒ‡å®šçš„ä¸šåŠ¡æœåŠ¡ï¼Œä¸šåŠ¡æœåŠ¡æ ¹æ®éœ€è¦è°ƒç”¨å¯¹åº”çš„æ•°æ®æ”¯æŒç«¯ã€RPCæœåŠ¡çŸ­ä¿¡æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡ç«¯ï¼Œå®Œæˆä¸šåŠ¡åŠŸèƒ½åè¿”å›å¯¹åº”çš„æ•°æ®ã€‚ æ•´ä¸ªéƒ¨ç½²æ¶æ„åˆ†ä¸ºå…¥å£è®¿é—®ç»„ã€æ ¸å¿ƒæœåŠ¡ç»„ã€åŸºç¡€æ”¯æ’‘ç»„å’ŒæœåŠ¡ç›‘æ§ç»„ã€‚ 1ã€LBSåŸŸåæŒ‡å‘æœåŠ¡åŸŸåï¼Œå¼€é€šhttpsã€é˜²ddocsç­‰å®‰å…¨æ€§åŠŸèƒ½ã€‚ 2ã€å…¥å£è®¿é—®ç»„åŒ…å«nginxã€potal webã€activity webã€gatewayæœåŠ¡ï¼Œnginxéœ€è¦å¼€é€šå¤–ç½‘æµé‡æƒé™ï¼Œgatewayéœ€æ‰“é€šä¸æ ¸å¿ƒä¸šåŠ¡ç»„ç½‘æ®µè°ƒç”¨ï¼Œpotal webå’Œactivity webä¸ºå‰ç«¯ç½‘é¡µæœåŠ¡ï¼Œå¯è§†æƒ…å†µä¸nginxæœåŠ¡åŒæœºå™¨éƒ¨ç½²æˆ–å•ç‹¬éƒ¨ç½²ã€‚ 3ã€æ ¸å¿ƒæœåŠ¡ç»„æ ¹æ®å„æœåŠ¡å‹æµ‹å’Œé¢„ä¼°QPSçŠ¶å†µï¼Œéƒ¨ç½²ç›¸åº”é‡çº§çš„æœåŠ¡èŠ‚ç‚¹ï¼Œä¸ºä¿éšœæœåŠ¡é«˜å¯ç”¨ï¼Œæ¯ä¸ªæœåŠ¡è‡³å°‘éƒ¨ç½²ä¸¤ä¸ªèŠ‚ç‚¹ã€‚ 4ã€åŸºç¡€æ”¯æ’‘ç»„éœ€å¼€æ”¾æ ¸å¿ƒä¸šåŠ¡ç»„ç½‘ç»œç›¸äº’è®¿é—®ï¼Œéƒ¨ç½²consulæ³¨å†Œä¸­å¿ƒé›†ç¾¤ï¼Œconsulé›†ç¾¤è¯·ç‹¬ç«‹éƒ¨ç½²å¹¶è‡³å°‘éƒ¨ç½²3ä¸ªserverèŠ‚ç‚¹å’Œ2+ä¸ªclientèŠ‚ç‚¹ï¼ŒDBè‡³å°‘ä¿è¯ä¸»ä»èŠ‚ç‚¹é…ç½®ï¼Œrabbitmqé›†ç¾¤ä½¿ç”¨é•œåƒæ¨¡å¼ä¿éšœæœåŠ¡çš„é«˜å¯ç”¨ï¼Œredisæ ¹æ®æœåŠ¡éœ€è¦ä¸»ä»ã€é›†ç¾¤éƒ¨ç½²ï¼Œå…¶ä»–æ”¯æŒæœåŠ¡æ ¹æ®éœ€è¦éƒ¨ç½²ç›¸åº”å¥—ä»¶ã€‚ æœåŠ¡ç›‘æ§ç»„éœ€å¼€æ”¾æ ¸å¿ƒä¸šåŠ¡ç»„ç½‘ç»œç›¸äº’è®¿é—®ï¼Œzabbixã€prometheusã€zipkin serveræ ¹æ®æœåŠ¡éœ€è¦éƒ¨ç½²ç›¸åº”èŠ‚ç‚¹å¥—ä»¶ï¼ŒELKéƒ¨ç½²è‡³å°‘3ä¸ªmasterèŠ‚ç‚¹å’Œ3ä¸ªdataèŠ‚ç‚¹ï¼Œæ•°æ®èŠ‚ç‚¹å»ºè®®å†…å­˜30Gï¼ŒmasterèŠ‚ç‚¹å»ºè®®10Gï¼ŒèšåˆèŠ‚ç‚¹ç­‰æ ¹æ®éœ€è¦é…ç½®ï¼Œæ—¥å¿—ç±»ç´¢å¼•æ ¹æ®éœ€è¦è®¾ç½®n*3ä¸ªPrimariesï¼ˆå¦‚æ— ç‰¹æ®Šéœ€è¦Replicasè®¾ç½®ä¸º0ï¼‰ï¼Œæ—¥å¿—ç´¢å¼•åç§°æŒ‰å¤©å­˜å‚¨ã€‚æ—¥å¿—æ”¶é›†é‡‡ç”¨filebeat -&gt; kafka -&gt; logstash -&gt; elasticsearchå¥—ä»¶ï¼Œlogstashè·¯ç”±pipelineç®€åŒ–é…ç½®å’ŒæœåŠ¡ç®¡ç†ã€‚ æ§åˆ¶ä¸­å¿ƒæ¨¡å—æœåŠ¡ç½‘å…³ gatewayæœåŠ¡ç½‘å…³åŸºäºspringcloudåŸç”Ÿgatewayå®ç°ï¼Œä¸ºæ•´ä¸ªå¾®æœåŠ¡æ¶æ„æä¾›ç®€å•ã€æœ‰æ•ˆå’Œç»Ÿä¸€çš„APIè·¯ç”±ç®¡ç†æ–¹å¼ï¼Œç»“åˆæœåŠ¡çš„æˆæƒä½“ç³»ã€é£æ§ä½“ç³»ã€sentinelæµæ§ä½“ç³»ã€swaggeræ¥å£æ–‡æ¡£ç­‰æ–¹ä¾¿ç»Ÿä¸€çš„ç®¡ç†å¾®æœåŠ¡ä½“ç³»ï¼ŒåŒæ—¶ä¿éšœæœåŠ¡çš„å®‰å…¨ç¨³å®šè¿è¡Œã€‚ æµæ§åå° sentinel-dashboardsentinelæµæ§åå°æ˜¯é¢å‘å¾®æœåŠ¡çš„è½»é‡çº§æµé‡æ§åˆ¶æ¡†æ¶ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚ ä»»åŠ¡è°ƒåº¦ xxl-job-adminxxl-jobä»»åŠ¡è°ƒåº¦ä¸­å¿ƒæ˜¯ä¸€ä¸ªè½»é‡çº§åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ é“¾è·¯è¿½è¸ª zipkinzipkiné“¾è·¯è¿½è¸ªåŸºäº Google Dapper å®ç°ï¼Œç”¨æ¥æ”¶é›†å„ä¸ªæœåŠ¡å™¨ä¸Šè¯·æ±‚é“¾è·¯çš„è·Ÿè¸ªæ•°æ®ï¼Œå¹¶é€šè¿‡æä¾›çš„ REST API æ¥å£æ¥è¾…åŠ©æŸ¥è¯¢è·Ÿè¸ªæ•°æ®ä»¥å®ç°å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç›‘æ§ç¨‹åºï¼Œä»è€ŒåŠæ—¶å‘ç°ç³»ç»Ÿä¸­çš„å­˜åœ¨çš„é£é™©æ€§é—®é¢˜ã€‚ å…¬å…±ç»„å»ºæ¨¡å—å…¬å…±é…ç½® configuratorå…¬å…±é…ç½®æ¨¡å—æ•´ç†å’Œä¼˜åŒ–äº†æœåŠ¡çš„å¸¸ç”¨é…ç½®ï¼Œé‡‡ç”¨é…ç½®ä½†ä¸å¯ç”¨çš„æ–¹å¼è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼ŒæœåŠ¡ä»…éœ€ç»§æ‰¿ç›¸åº”ç±»å¹¶åŠ ä¸Šæ³¨è§£@Configurationå°±å¯ä»¥å¯ç”¨åŠŸèƒ½ã€‚ å…¬å…±èµ„æº frameworkå…¬å…±èµ„æºæ¨¡å—èšåˆç±»ä¸€äº›å¸¸ç”¨ä½†å…¬å…±å¤„ç†ç±»ï¼Œå¢å¼ºæœåŠ¡è¯­æ³•çš„ç»Ÿä¸€æ€§å’ŒåŠŸèƒ½çš„å‡†ç¡®æ€§ï¼Œå‡å°‘å¤§é‡é‡å¤é€ è½®å­çš„ç°è±¡ã€‚ åºåˆ—å·ç»„ä»¶ serialnoåºåˆ—å·ç”Ÿæˆç»„ä»¶èƒ½å¤Ÿè‡ªåŠ¨äº§ç”ŸæŒ‡å®šåŠŸèƒ½çš„é€’å¢åºåˆ—å·ï¼Œé‡‡ç”¨æœåŠ¡ç‹¬ç«‹è‡ªä¸»ç®¡ç†åºåˆ—å·çš„æ–¹å¼ï¼Œé™ä½ä½¿ç”¨ç‹¬ç«‹åºåˆ—å·æœåŠ¡çš„è€¦åˆæ€§ï¼Œé‡‡ç”¨redisä½œä¸ºé¢„ç”Ÿæˆåºåˆ—å·æ± ç¼“å­˜åŒºï¼ŒåŠ é€ŸæœåŠ¡çš„IDè·å–çš„å¤„ç†é€Ÿåº¦ã€‚ æ¶ˆæ¯ç»„ä»¶å°è£… rabbit-mqæ¶ˆæ¯ç»„ä»¶å°è£…é»˜è®¤å°è£…çš„æ˜¯rabbitçš„topicæ¨¡å¼ï¼Œç»“åˆå»¶è¿Ÿæ’ä»¶é»˜è®¤ç”Ÿæˆæ™®é€štopicäº¤æ¢æœºå’Œå»¶è¿Ÿé˜Ÿåˆ—äº¤æ¢æœºï¼Œåœ¨ç”Ÿäº§ç«¯è°ƒç”¨å‘é€æ¶ˆæ¯æ˜¯æ˜¯å¦ä¸ºå»¶è¿Ÿæ¶ˆæ¯ï¼Œæ¶ˆè´¹é…ç½®queueæ—¶é€‰æ‹©æ˜¯å¦ä¸ºå»¶è¿Ÿé˜Ÿåˆ—ã€‚ä¸€èˆ¬æƒ…å†µä¸‹topicæ¨¡å¼+å»¶è¿Ÿé˜Ÿåˆ—èƒ½å¤Ÿå®Œå…¨æ»¡è¶³æœåŠ¡çš„å„ç§æ¶ˆæ¯éœ€æ±‚ã€‚ åˆ†å¸ƒå¼é”ç»„ä»¶ distribution-lockåˆ†å¸ƒå¼é”ç»„ä»¶æä¾›äº†åˆ†å¸ƒå¼æœåŠ¡é”çš„åŠŸèƒ½ï¼Œé‡‡ç”¨redisä½œä¸ºé”çš„è®¡ç®—æ ¸å¿ƒï¼Œå¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸Šæ³¨è§£å£°æ˜é”ï¼ŒåŒæ—¶é‡‡ç”¨æ³¨è§£æ–¹æ³•å‚æ•°ä½œä¸ºé™ä½é”ç²’åº¦ï¼Œä»è€Œæ›´åŠ çµæ´»å®Œå–„çš„æ”¯æ’‘ä¸šåŠ¡åŠŸèƒ½ã€‚ åˆ†åº“åˆ†è¡¨ç»„ä»¶ sharding-dbåˆ†åº“åˆ†è¡¨ç»„ä»¶å°è£…äº†sharding-jdbcä½œä¸ºåŠŸèƒ½å†…æ ¸ï¼Œè°ƒæ•´ä¼˜åŒ–äº†é…ç½®æ–¹å¼å’Œæ”¯æŒç±»å‹ï¼Œå¯åœ¨å¤§é‡ä¸æ”¹å˜é…ç½®æ–‡ä»¶çš„çŠ¶å†µæ‰©å±•å‡ºå•åº“æ•°æ®æºã€ä¸»ä»æ•°æ®æºã€åˆ†åº“æ•°æ®æºä¸‰ç§é…ç½®æ¨¡å¼ï¼Œæå¤§çš„æ–¹ä¾¿æœåŠ¡å‡çº§æ”¹é€ ã€‚ æµæ§é™çº§ç»„ä»¶ sentinel-clientæµæ§é™çº§ç»„ä»¶å°è£…äº†sentinelä½œä¸ºåŠŸèƒ½å†…æ ¸ï¼Œè°ƒæ•´ä¼˜åŒ–äº†åˆ†å¸ƒå¼é…ç½®å­˜å–ã€å®æ—¶ç›‘æ§æ•°æ®æŒä¹…å­˜å‚¨å’Œæµæ§ç†”æ–­å¼‚å¸¸å¤„ç†é€»è¾‘ï¼Œå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡çŠ¶å†µã€åŠ¨æ€è°ƒæ•´æœåŠ¡çš„ç†”æ–­æˆ–æµæ§é˜ˆå€¼ï¼Œç»“åˆæµæ§ç†”æ–­ç›‘æ§æŠ¥è­¦å®æ—¶ä¿éšœæœåŠ¡çš„å®‰å…¨ç¨³å®šã€‚ æ ‡å‡†æœåŠ¡ç»“æ„weiechoæ ‡å‡†æœåŠ¡åŒ…å«xxx-appï¼ˆæœåŠ¡å¯åŠ¨å…¥å£ï¼‰ã€xxx-coreï¼ˆä¸šåŠ¡åŠŸèƒ½æ ¸å¿ƒï¼‰ã€xxx-enumï¼ˆæœåŠ¡å…¨å±€æšä¸¾ï¼‰ã€xxx-jobï¼ˆå®šæ—¶ä»»åŠ¡åŒ…ï¼‰ã€xxx-rpcï¼ˆrpcæœåŠ¡æ¥å£SDKï¼‰æ¨¡å—ï¼Œè€ƒè™‘åˆæœŸä¸šåŠ¡é‡ã€ç»´æŠ¤äººå‘˜ã€æœåŠ¡ç»´æŠ¤éš¾åº¦åŠå¤§éƒ¨åˆ†å¾®æœåŠ¡åŠŸèƒ½ç­‰çŠ¶å†µï¼Œæ ‡å‡†æœåŠ¡ç»“æ„é‡‡ç”¨å•æœåŠ¡èšåˆéƒ¨ç½²æ–¹å¼ï¼Œé™ä½å¼€å‘ç»´æŠ¤éš¾åº¦ï¼ŒåŠ é€ŸæœåŠ¡ä¸šåŠ¡åŠŸèƒ½è¿­ä»£å¼€å‘ä¸Šçº¿ã€‚ æœ¬æ¡†æ¶ä¸ºä¿éšœæœåŠ¡æ¥å£çš„å®‰å…¨åŠä¸€è‡´æ€§ï¼Œåˆ©ç”¨å¼ºçº¦æŸçš„æ–¹å¼ä¿éšœæ‰€æœ‰é—®é¢˜æš´éœ²åœ¨ä¸Šçº¿éƒ¨ç½²å‰ï¼Œçº¦å®šæœåŠ¡æä¾›æ–¹ç¼–å†™è¿œç¨‹è°ƒç”¨æ¥å£SDKæä¾›ç»™è°ƒç”¨æ–¹ã€‚ æ¨¡å—ç»§æ‰¿è§„åˆ™ï¼š 1ã€xxx-appå¯å¼•å…¥xxx-coreã€xxx-jobã€xxx-rpcæ¨¡å—ï¼› 2ã€xxx-coreå¯å¼•å…¥xxx-enumæ¨¡å—ï¼Œæ”¯æ’‘ä¸šåŠ¡æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œå¯æœåŠ¡ä¸šåŠ¡é‡çŠ¶å†µæ‹†åˆ†å‡ºeventï¼ˆMQäº‹ä»¶ï¼‰æ¨¡å—èµ°ç‹¬ç«‹æœåŠ¡å…¥å£ï¼› 3ã€xxx-jobæ ¹æ®éœ€è¦ä½¿ç”¨xxx-appæœåŠ¡å…¥å£æˆ–ç‹¬ç«‹æœåŠ¡èµ°ä»»åŠ¡æœåŠ¡å…¥å£ï¼› 4ã€xxx-rpcå¯å¼•å…¥xxx-enumæ¨¡å—ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨xxx-appæœåŠ¡å…¥å£æˆ–ç‹¬ç«‹æœåŠ¡èµ°ä»»åŠ¡æœåŠ¡å…¥å£ã€‚ æœåŠ¡å¯åŠ¨å…¥å£ xxx-appxxxApplication.javaä¸ºæœåŠ¡å¯åŠ¨å…¥å£ç±»ï¼Œä¸»è¦åŒ…å«springbootæœåŠ¡å¯åŠ¨mainæ–¹æ³•å’Œéƒ¨åˆ†å¯åŠ¨æ³¨è§£ï¼› cn.echo.xxx.configä¸ºæœåŠ¡é…ç½®åŒ…ï¼Œä¸»è¦åŒ…å«æœåŠ¡åˆå§‹åŒ–å„é¡¹é…ç½®ç±»ï¼Œå¦‚ï¼šdatabaseã€redisã€cacheã€mqã€mvcã€jobç­‰é…ç½®ï¼› cn.echo.xxx.controllerä¸ºæ¥å£æ§åˆ¶åŒ…ï¼ŒåŒ…å«apiï¼ˆä¸šåŠ¡æ¥å£ï¼‰ã€portalï¼ˆåå°æ¥å£ï¼‰ã€rpcï¼ˆrpcæ¥å£ï¼‰æ§åˆ¶å®ç°ç±»ï¼Œå…¶ä¸­rpcä¸ºç»§æ‰¿xxx-rpcæ¨¡å—ç­‰å®ç°ç±»ï¼› cn.echo.xxx.execptionä¸ºæœåŠ¡å¼‚å¸¸å¤„ç†åŒ…ï¼Œé»˜è®¤åŒ…å«GlobalExceptionHandlerç»§æ‰¿å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ç±»cn.echo.framework.response.DefaultGlobalExceptionHandlerã€‚ ä¸šåŠ¡åŠŸèƒ½æ ¸å¿ƒ xxx-corecn.echo.xxx.core.daoä¸ºæ•°æ®å¤„ç†åŒ…ï¼Œä¸»è¦åŒ…å«mybatisè°ƒç”¨æ•°æ®æºæ¥å£ç±»ï¼› cn.echo.xxx.core.entityä¸ºæ•°æ®å®ä½“åŒ…ï¼Œä¸»è¦åŒ…å«æ•°æ®åº“è¡¨å¯¹åº”å­—æ®µå®ä½“ç±»ï¼› cn.echo.xxx.core.pojoä¸ºä¸šåŠ¡å®ä½“åŒ…ï¼Œä¸»è¦ä¸ºä¸šåŠ¡ä¸Šä¸‹æ–‡å°è£…éœ€è¦çš„ç›¸å…³å®ä½“ç±»ï¼› cn.echo.xxx.core.eventä¸ºMQäº‹ä»¶åŒ…ï¼Œä¸»è¦åŒ…å«constantï¼ˆå¸¸é‡ï¼‰ã€receiverï¼ˆæ¥æ”¶å¤„ç†ï¼‰ã€senderï¼ˆå‘é€å¤„ç†ï¼‰ï¼Œå…¶ä¸­constantä¸»è¦åŒ…å«queueã€routing keyå¸¸é‡å®šä¹‰ï¼› cn.echo.xxx.core.serviceä¸ºä¸šåŠ¡é€»è¾‘æ¥å£åŒ…ï¼Œä¸»è¦å®šä¹‰ä¸šåŠ¡é€»è¾‘åŠŸèƒ½æ¥å£ï¼Œimplä¸ºé€»è¾‘æ¥å£çš„å®ç°ç±»ã€‚ æœåŠ¡å…¨å±€æšä¸¾ xxx-enumcn.echo.xxx.em.enumsä¸ºå…¨å±€æšä¸¾åŒ…ï¼Œä¸»è¦é…åˆä¸šåŠ¡éœ€è¦å®šä¹‰å„ç±»æšä¸¾ï¼› cn.echo.xxx.em.responseä¸ºå…¨å±€æœåŠ¡å“åº”ç åŒ…ï¼Œä¸»è¦ç‰¹æ®Šä¸šåŠ¡çŠ¶å†µä¸‹è¿”å›çš„ä¿¡æ¯æç¤ºç ï¼ˆè­¦å‘Šã€å¼‚å¸¸ç­‰ï¼‰ï¼Œæ­¤å¼‚å¸¸ç åœ¨æœåŠ¡åˆ›å»ºæ—¶ç»Ÿä¸€åˆ†é…å‰ç¼€ï¼Œå„æœåŠ¡ç»´æŠ¤è‡ªå·±çš„å¼‚å¸¸ç ï¼Œå¼‚å¸¸ç ç±»ç»§æ‰¿è‡ªæ¡†æ¶ç±»cn.echo.framework.response.ResultCodeã€‚ å®šæ—¶ä»»åŠ¡åŒ… xxx-jobcn.echo.xxx.jobä¸ºå®šæ—¶ä»»åŠ¡å®ç°åŒ…ï¼Œåˆ©ç”¨xxljobå®ç°ä»»åŠ¡è°ƒåº¦å·¥ä½œï¼Œæ ¹æ®æœ€æ–°2.2.0ç‰ˆæœ¬å®ç°ï¼Œåœ¨æ–¹æ³•ä½“æ³¨è§£@XxlJob(â€œxxxHandlerâ€)å¹¶æŒ‰ç…§å®˜æ–¹è¯­æ³•å³å¯å®Œæˆä»»åŠ¡å¼€å‘ï¼Œç»“åˆåå°é…ç½®è§„åˆ™å®ç°åŠ¨æ€ä»»åŠ¡è°ƒåº¦ç®¡ç†ã€‚ è¿œç¨‹è°ƒç”¨æ¥å£SDK xxx-rpccn.echo.xxx.rpc.clientè¿œç¨‹è°ƒç”¨SDKæ¥å£åŒ…ï¼Œç”¨äºå®šä¹‰FeignClientæä¾›ç»™è°ƒç”¨æ–¹çš„æ¥å£ï¼› cn.echo.xxx.rpc.dtoè¿œç¨‹è°ƒç”¨SDKæ¥å£å®ä½“åŒ…ï¼Œä¸»è¦ä¸ºSDKæ¥å£ä¸Šä¸‹æ–‡å°è£…éœ€è¦çš„ç›¸å…³å®ä½“ç±»ã€‚","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://github.com/weiecho/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84/"},{"name":"lemon-echo","slug":"lemon-echo","permalink":"https://github.com/weiecho/tags/lemon-echo/"}]},{"title":"Sentinelæµæ§é™çº§åŸåˆ™","slug":"stu_1117","date":"2020-07-02T06:06:55.000Z","updated":"2020-07-03T06:10:14.732Z","comments":true,"path":"2020/07/02/stu_1117/","link":"","permalink":"https://github.com/weiecho/2020/07/02/stu_1117/","excerpt":"","text":"é¡¹ç›®åœ°å€ï¼šsentinelæµæ§é˜²æŠ¤ åŸºæœ¬åŸåˆ™ Sentinel æ˜¯å›´ç»•ç€èµ„æºæ¥å·¥ä½œçš„ã€‚ ç¼–ç æ—¶ï¼Œåªéœ€è¦å…³å¿ƒå¦‚ä½•å®šä¹‰èµ„æºï¼Œå³å“ªäº›æ–¹æ³•/ä»£ç å—éœ€è¦ä¿æŠ¤ï¼Œè€Œä¸éœ€è¦å…³æ³¨å¦‚ä½•ä¿æŠ¤è¿™ä¸ªèµ„æºã€‚ é€šè¿‡æ·»åŠ è§„åˆ™æ¥ä¿æŠ¤èµ„æºï¼Œè§„åˆ™æ·»åŠ å³æ—¶ç”Ÿæ•ˆã€‚ è§„åˆ™é…ç½®åŸåˆ™ æŒ‰ç…§åº”ç”¨å¤„ç†èƒ½åŠ›è¿›è¡Œæµæ§ï¼š æŒ‰æœåŠ¡æä¾›æ–¹æµæ§åŸåˆ™ å‰Šå³°å¡«è°·åŸåˆ™ å†·å¯åŠ¨åŸåˆ™ è”åŠ¨æ§åˆ¶åŸåˆ™ å¼ºä¾èµ–éš”ç¦»åŸåˆ™ å¼±ä¾èµ–é™çº§åŸåˆ™ ç³»ç»Ÿä¿æŠ¤åŸåˆ™ï¼Œè¯¦æƒ…è¯·å‚è§[ç³»ç»Ÿä¿æŠ¤ç¯‡] å¼±ä¾èµ–é™çº§å½“è‹¥ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº”ç”¨å‡ºé”™ä¸ä¼šå½±å“è€Œæ•´ä½“æµç¨‹ï¼Œåˆ™ç§°ä¹‹ä¸ºå¼±ä¾èµ–ã€‚å¯¹äºå¼±ä¾èµ–ä¸ç¨³å®šæ—¶ï¼Œéœ€è¦é…ç½®é™çº§åŸåˆ™æ¥ä¿æŠ¤ç³»ç»Ÿç¨³å®šæ€§ã€‚ åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œåº”ç”¨é€šå¸¸ä¼šè°ƒç”¨ä¾èµ–æ–¹ï¼ˆè¿œç¨‹æœåŠ¡ã€æ•°æ®åº“ã€ç¬¬ä¸‰æ–¹ API ç­‰ï¼‰æ¥å®ŒæˆæœåŠ¡ã€‚ä¾‹å¦‚ï¼Œæ”¯ä»˜çš„æ—¶éœ€è¦è¿œç¨‹è°ƒç”¨é“¶è”æä¾›çš„ APIã€‚ç„¶è€Œä¾èµ–æ–¹çš„ç¨³å®šæ€§æ˜¯ä¸èƒ½ä¿è¯çš„ã€‚è‹¥ä¾èµ–æ–¹å‡ºç°ä¸ç¨³å®šçš„æƒ…å†µï¼Œåˆ™è¯·æ±‚å’Œè°ƒç”¨ä¾èµ–æ–¹çš„æ–¹æ³•çš„çš„å“åº”æ—¶é—´å˜é•¿ï¼Œçº¿ç¨‹äº§ç”Ÿå †ç§¯ï¼Œæœ€ç»ˆå¯èƒ½è€—å°½è‡ªèº«çš„çº¿ç¨‹æ•°ï¼Œå¯¼è‡´åº”ç”¨æœ¬èº«ä¸å¯ç”¨ã€‚ åœ¨å¤æ‚é“¾è·¯ä¸­ï¼Œè‹¥æŸä¸€ç¯ä¸ç¨³å®šï¼Œå°±å¯èƒ½ä¼šå±‚å±‚æ¸²æŸ“ï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªé“¾è·¯éƒ½ä¸å¯ç”¨ã€‚ é’ˆå¯¹ä»¥ä¸Šæƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨å¯¹ä¾èµ–æ–¹é…ç½®é™çº§åŸåˆ™æ¥ä¿è¯ç³»ç»Ÿç¨³å®šæ€§ã€‚ ###å¼ºä¾èµ–éš”ç¦» è‹¥ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº”ç”¨æˆ–ç»„ä»¶ï¼Œæˆ–è€…åº”ç”¨è‡ªèº«çš„å†…éƒ¨æ–¹æ³•å‡ºé”™ä¼šå½±å“è€Œæ•´ä½“æµç¨‹ï¼Œåˆ™ç§°ä¹‹ä¸ºå¼ºä¾èµ–ã€‚å¯¹äºå¼ºä¾èµ–ï¼Œéœ€è¦é…ç½®éš”ç¦»åŸåˆ™æ¥ä¿æŠ¤ç³»ç»Ÿç¨³å®šæ€§ã€‚ å½“å¼ºä¾èµ–å‡ºç°ä¸ç¨³å®šçš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡é…ç½®å¹¶å‘çº¿ç¨‹æ•°éš”ç¦»åŸåˆ™æ¥é™åˆ¶ä¸ç¨³å®šçš„å¼ºä¾èµ–å¹¶å‘æ•°ï¼Œéš”ç¦»å¼ºä¾èµ–ã€‚é…ç½®å¹¶å‘çº¿ç¨‹æ•°éš”ç¦»åŸåˆ™åï¼Œæ— éœ€å†è¿›è¡Œçº¿ç¨‹æ± éš”ç¦»ï¼Œsentinel ä¼šæ§åˆ¶èµ„æºçš„çº¿ç¨‹æ•°ã€‚å½“è¯·æ±‚æ•°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œsentinel å°†æ‹’ç»å¤šä½™çš„è¯·æ±‚ï¼Œç›´åˆ°å †ç§¯çš„çº¿ç¨‹å¤„ç†å®Œæˆï¼Œä»¥æ­¤æ¥è¾¾åˆ°ä¿¡å·é‡éš”ç¦»çš„æ•ˆæœã€‚ çº¿ç¨‹æ•°ç›®è¶…å‡ºæ—¶ï¼Œè®¾ç½® å¿«é€Ÿå¤±è´¥ èƒ½å¤Ÿæœ‰æ•ˆåœ°é˜²æ­¢è‡ªå·±è¢«æ…¢è°ƒç”¨æ‰€å½±å“ã€‚ ç³»ç»Ÿé˜²æŠ¤ç³»ç»Ÿé˜²æŠ¤å³ä»æ•´ä½“ç»´åº¦å¯¹åº”ç”¨å…¥å£æµé‡è¿›è¡Œæ§åˆ¶ï¼Œç»“åˆåº”ç”¨çš„ Loadã€æ€»ä½“å¹³å‡ RTã€å…¥å£ QPS å’Œçº¿ç¨‹æ•°ç­‰å‡ ä¸ªç»´åº¦çš„ç›‘æ§æŒ‡æ ‡ï¼Œè®©ç³»ç»Ÿçš„å…¥å£æµé‡å’Œç³»ç»Ÿçš„è´Ÿè½½è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œè®©ç³»ç»Ÿå°½å¯èƒ½è·‘åœ¨æœ€å¤§ååé‡çš„åŒæ—¶ä¿è¯ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ã€‚ ä¸€èˆ¬æ€§ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„æ€è·¯æ˜¯æ ¹æ®ç¡¬æŒ‡æ ‡å³ç³»ç»Ÿçš„è´Ÿè½½æ¥åšç³»ç»Ÿè¿‡è½½ä¿æŠ¤ã€‚å³å½“ç³»ç»Ÿè´Ÿè½½é«˜äºæŸä¸ªé˜ˆå€¼ï¼Œå°±ç¦æ­¢æˆ–è€…å‡å°‘æµé‡çš„è¿›å…¥ï¼›è‹¥è´Ÿè½½æ¢å¤ï¼Œåˆ™æ¢å¤æµé‡çš„è¿›å…¥ã€‚è¿™æ ·ä¼šé€ æˆä¸¤ä¸ªä¸å¯é¿å…çš„é—®é¢˜ï¼š è‹¥æ ¹æ®è´Ÿè½½çš„æƒ…å†µæ¥è°ƒèŠ‚æµé‡çš„é€šè¿‡ç‡ï¼Œåˆ™ä¼šäº§ç”Ÿå»¶è¿Ÿã€‚è‹¥å½“å‰é€šè¿‡ç‡çš„è°ƒæ•´ä¼šå¯¼è‡´è´Ÿè½½å¢å¤§ï¼Œé‚£ä¹ˆè‡³å°‘è¦è¿‡ 1 ç§’ä¹‹åæ‰èƒ½è¢«è§‚æµ‹åˆ°ï¼›åŒç†ï¼Œè‹¥å½“å‰é€šè¿‡ç‡è°ƒæ•´ä¼šä½¿è´Ÿè½½é™ä½ï¼Œä¹Ÿéœ€è¦ 1 ç§’ä¹‹åæ‰èƒ½ç»§ç»­è°ƒæ•´ã€‚è¿™ç§æ–¹æ³•ä¼šæµªè´¹ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚å¯¼è‡´æˆ‘ä»¬çœ‹åˆ°çš„è´Ÿè½½æ›²çº¿äº§ç”Ÿé”¯é½¿ã€‚ é€šè¿‡ç‡æ¢å¤æ…¢ã€‚åœ¨ä¸‹æ¸¸åº”ç”¨ä¸å¯é ï¼Œåº”ç”¨å“åº”æ—¶é—´å¾ˆé•¿ï¼Œä»è€Œå¯¼è‡´è´Ÿè½½å¾ˆé«˜çš„åœºæ™¯ä¸­ï¼Œè‹¥ä¸‹æ¸¸åº”ç”¨æ¢å¤æ—¶ï¼Œåº”ç”¨å“åº”æ—¶é—´ä¹Ÿä¼šéšä¹‹å‡çŸ­ï¼Œæ­¤æ—¶é€šè¿‡ç‡ç†åº”ä¼šå¤§å¹…åº¦å¢å¤§ã€‚ä½†ç”±äºæ­¤æ—¶è´Ÿè½½ä»ç„¶å¾ˆé«˜ï¼Œæ‰€ä»¥é€šè¿‡ç‡çš„æ¢å¤æ…¢ã€‚ ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œsentinelåœ¨ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„åšæ³•æ˜¯ï¼šç”¨æ¯åˆ†é’Ÿçš„è´Ÿè½½ä½œä¸ºå¯åŠ¨æ§åˆ¶æµé‡ï¼Œä½¿ç”¨è¯·æ±‚çš„å“åº”æ—¶é—´ä»¥åŠå½“å‰ç³»ç»Ÿæ­£åœ¨å¤„ç†çš„è¯·æ±‚é€Ÿç‡æ¥å†³å®šé€šè¿‡çš„æµé‡ã€‚æ—¨åœ¨åœ¨ç³»ç»Ÿä¸è¢«æ‹–å®çš„æƒ…å†µä¸‹ï¼Œæé«˜ç³»ç»Ÿçš„ååç‡ã€‚","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"æµæ§é™çº§","slug":"æµæ§é™çº§","permalink":"https://github.com/weiecho/tags/%E6%B5%81%E6%8E%A7%E9%99%8D%E7%BA%A7/"},{"name":"sentinel","slug":"sentinel","permalink":"https://github.com/weiecho/tags/sentinel/"}]},{"title":"Sentinelç³»ç»Ÿé˜²æŠ¤","slug":"stu_1116","date":"2020-06-20T02:23:41.000Z","updated":"2020-07-03T06:06:06.058Z","comments":true,"path":"2020/06/20/stu_1116/","link":"","permalink":"https://github.com/weiecho/2020/06/20/stu_1116/","excerpt":"","text":"ç³»ç»Ÿé˜²æŠ¤å³ä»æ•´ä½“ç»´åº¦å¯¹åº”ç”¨å…¥å£æµé‡è¿›è¡Œæ§åˆ¶ï¼Œç»“åˆåº”ç”¨çš„ Loadã€æ€»ä½“å¹³å‡ RTã€å…¥å£ QPS å’Œçº¿ç¨‹æ•°ç­‰å‡ ä¸ªç»´åº¦çš„ç›‘æ§æŒ‡æ ‡ï¼Œè®©ç³»ç»Ÿçš„å…¥å£æµé‡å’Œç³»ç»Ÿçš„è´Ÿè½½è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œè®©ç³»ç»Ÿå°½å¯èƒ½è·‘åœ¨æœ€å¤§ååé‡çš„åŒæ—¶ä¿è¯ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ã€‚ é¡¹ç›®åœ°å€ï¼šsentinelæµæ§é˜²æŠ¤ èƒŒæ™¯ä¿¡æ¯é•¿æœŸä»¥æ¥ï¼Œç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„æ€è·¯æ˜¯æ ¹æ®ç¡¬æŒ‡æ ‡å³ç³»ç»Ÿçš„è´Ÿè½½æ¥åšç³»ç»Ÿè¿‡è½½ä¿æŠ¤ã€‚å³å½“ç³»ç»Ÿè´Ÿè½½é«˜äºæŸä¸ªé˜ˆå€¼ï¼Œå°±ç¦æ­¢æˆ–è€…å‡å°‘æµé‡çš„è¿›å…¥ï¼›è‹¥è´Ÿè½½æ¢å¤ï¼Œåˆ™æ¢å¤æµé‡çš„è¿›å…¥ã€‚è¿™æ ·ä¼šé€ æˆä¸¤ä¸ªä¸å¯é¿å…çš„é—®é¢˜ï¼š è‹¥æ ¹æ®è´Ÿè½½çš„æƒ…å†µæ¥è°ƒèŠ‚æµé‡çš„é€šè¿‡ç‡ï¼Œåˆ™ä¼šäº§ç”Ÿå»¶è¿Ÿã€‚è‹¥å½“å‰é€šè¿‡ç‡çš„è°ƒæ•´ä¼šå¯¼è‡´è´Ÿè½½å¢å¤§ï¼Œé‚£ä¹ˆè‡³å°‘è¦è¿‡ 1 ç§’ä¹‹åæ‰èƒ½è¢«è§‚æµ‹åˆ°ï¼›åŒç†ï¼Œè‹¥å½“å‰é€šè¿‡ç‡è°ƒæ•´ä¼šä½¿è´Ÿè½½é™ä½ï¼Œä¹Ÿéœ€è¦ 1 ç§’ä¹‹åæ‰èƒ½ç»§ç»­è°ƒæ•´ã€‚è¿™ç§æ–¹æ³•ä¼šæµªè´¹ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚å¯¼è‡´æˆ‘ä»¬çœ‹åˆ°çš„è´Ÿè½½æ›²çº¿äº§ç”Ÿé”¯é½¿ã€‚ é€šè¿‡ç‡æ¢å¤æ…¢ã€‚åœ¨ä¸‹æ¸¸åº”ç”¨ä¸å¯é ï¼Œåº”ç”¨å“åº”æ—¶é—´å¾ˆé•¿ï¼Œä»è€Œå¯¼è‡´è´Ÿè½½å¾ˆé«˜çš„åœºæ™¯ä¸­ï¼Œè‹¥ä¸‹æ¸¸åº”ç”¨æ¢å¤æ—¶ï¼Œåº”ç”¨å“åº”æ—¶é—´ä¹Ÿä¼šéšä¹‹å‡çŸ­ï¼Œæ­¤æ—¶é€šè¿‡ç‡ç†åº”ä¼šå¤§å¹…åº¦å¢å¤§ã€‚ä½†ç”±äºæ­¤æ—¶è´Ÿè½½ä»ç„¶å¾ˆé«˜ï¼Œæ‰€ä»¥é€šè¿‡ç‡çš„æ¢å¤æ…¢ã€‚ ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œsentinel åº”ç”¨æµæ§é™çº§åœ¨ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„åšæ³•æ˜¯ï¼šç”¨æ¯åˆ†é’Ÿçš„è´Ÿè½½ä½œä¸ºå¯åŠ¨æ§åˆ¶æµé‡ï¼Œä½¿ç”¨è¯·æ±‚çš„å“åº”æ—¶é—´ä»¥åŠå½“å‰ç³»ç»Ÿæ­£åœ¨å¤„ç†çš„è¯·æ±‚é€Ÿç‡æ¥å†³å®šé€šè¿‡çš„æµé‡ã€‚æ—¨åœ¨åœ¨ç³»ç»Ÿä¸è¢«æ‹–å®çš„æƒ…å†µä¸‹ï¼Œæé«˜ç³»ç»Ÿçš„ååç‡ã€‚ åŠŸèƒ½åŸç†æˆ‘ä»¬æŠŠç³»ç»Ÿå¤„ç†è¯·æ±‚çš„è¿‡ç¨‹æƒ³è±¡ä¸ºä¸€ä¸ªæ°´ç®¡ï¼Œåˆ°æ¥çš„è¯·æ±‚æ˜¯å¾€è¿™ä¸ªæ°´ç®¡çŒæ°´ï¼Œå½“ç³»ç»Ÿå¤„ç†é¡ºç•…çš„æ—¶å€™ï¼Œè¯·æ±‚ä¸éœ€è¦æ’é˜Ÿï¼Œç›´æ¥ä»æ°´ç®¡ä¸­ç©¿è¿‡ï¼Œè¿™ä¸ªè¯·æ±‚çš„RTæ˜¯æœ€çŸ­çš„ï¼›åä¹‹ï¼Œå½“è¯·æ±‚å †ç§¯çš„æ—¶å€™ï¼Œé‚£ä¹ˆå¤„ç†è¯·æ±‚çš„æ—¶é—´åˆ™ä¼šå˜ä¸ºï¼šæ’é˜Ÿæ—¶é—´ + æœ€çŸ­å¤„ç†æ—¶é—´ã€‚ åŠŸèƒ½åŸç† è‹¥ç”¨ T æ¥è¡¨ç¤ºæ°´ç®¡å†…éƒ¨çš„æ°´é‡ï¼Œç”¨ RT æ¥è¡¨ç¤ºè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œç”¨ P æ¥è¡¨ç¤ºè¿›æ¥çš„è¯·æ±‚æ•°ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯·æ±‚ä»è¿›å…¥æ°´ç®¡é“åˆ°ä»æ°´ç®¡å‡ºæ¥ï¼Œè¿™ä¸ªæ°´ç®¡ä¼šå­˜åœ¨ P * RT ä¸ªè¯·æ±‚ã€‚å³å½“ T â‰ˆ QPS * Avg(RT) çš„æ—¶å€™ï¼Œå¯ä»¥è®¤ä¸ºç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›å’Œå…è®¸è¿›å…¥çš„è¯·æ±‚ä¸ªæ•°è¾¾åˆ°äº†å¹³è¡¡ï¼Œç³»ç»Ÿçš„è´Ÿè½½ä¸ä¼šç»§ç»­å¢åŠ ã€‚å½“å…¥å£çš„æµé‡æ˜¯æ°´ç®¡å‡ºæ¥çš„æµé‡çš„æœ€å¤§çš„å€¼çš„æ—¶å€™ï¼Œæ°´ç®¡çš„å¤„ç†èƒ½åŠ›è¾¾åˆ°æœ€å¤§åˆ©ç”¨ã€‚ ç³»ç»Ÿè§„åˆ™ç³»ç»Ÿä¿æŠ¤è§„åˆ™æ˜¯åº”ç”¨æ•´ä½“ç»´åº¦çš„ï¼Œè€Œä¸æ˜¯èµ„æºç»´åº¦çš„ï¼Œå¹¶ä¸”ä»…å¯¹å…¥å£æµé‡ç”Ÿæ•ˆã€‚å…¥å£æµé‡æŒ‡çš„æ˜¯è¿›å…¥åº”ç”¨çš„æµé‡ï¼ˆEntryType.INï¼‰ï¼Œä¾‹å¦‚ Web æœåŠ¡æˆ– Dubbo æœåŠ¡ç«¯æ¥æ”¶çš„è¯·æ±‚ï¼Œéƒ½å±äºå…¥å£æµé‡ã€‚ç³»ç»Ÿè§„åˆ™æ”¯æŒå››ç§é˜ˆå€¼ç±»å‹ï¼š Loadï¼ˆä»…å¯¹ Linux/Unix-like æœºå™¨ç”Ÿæ•ˆï¼‰ï¼šå½“ç³»ç»Ÿ load1 è¶…è¿‡é˜ˆå€¼ä¸”ç³»ç»Ÿå½“å‰çš„å¹¶å‘çº¿ç¨‹æ•°è¶…è¿‡ç³»ç»Ÿå®¹é‡æ—¶æ‰ä¼šè§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ RTï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹³å‡ RT è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ çº¿ç¨‹æ•°ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹¶å‘çº¿ç¨‹æ•°è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ å…¥å£ QPSï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„ QPS è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"æµæ§é™çº§","slug":"æµæ§é™çº§","permalink":"https://github.com/weiecho/tags/%E6%B5%81%E6%8E%A7%E9%99%8D%E7%BA%A7/"},{"name":"sentinel","slug":"sentinel","permalink":"https://github.com/weiecho/tags/sentinel/"}]},{"title":"shardingsphereä¸æ”¯æŒLocalDateTime/LocalDate","slug":"exp_1116","date":"2020-06-17T07:56:39.000Z","updated":"2020-07-01T12:59:06.479Z","comments":true,"path":"2020/06/17/exp_1116/","link":"","permalink":"https://github.com/weiecho/2020/06/17/exp_1116/","excerpt":"","text":"12345678shardingsphereé»˜è®¤ä½¿ç”¨ç­‰jdkç‰ˆæœ¬æ˜¯1.7ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰æ”¯æŒjdk1.8+çš„LocalDateTimeç­‰ç‰¹æ€§æˆ‘å·²ç»åœ¨forkä¸Šæ‰©å±•äº†è¿™ä¸ªç‰¹æ€§ï¼Œå¹¶å°†JDKçš„åŠŸèƒ½å‡çº§åˆ°jdk1.8ã€‚ä¸»è¦éªŒè¯äº†æ”¯æŒ Mybatis5+4.0.0-RC2-1.8https:&#x2F;&#x2F;github.com&#x2F;lonyee1989&#x2F;incubator-shardingsphere&#x2F;tree&#x2F;4.0.0-RC2-1.8 ç›´æ¥ä¸Šå®ç°ä»£ç forkä»£ç  1ã€package org.apache.shardingsphere.shardingjdbc.jdbc.core.resultset; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657/** * Convert value via expected class type. * * @param value original value * @param convertType expected class type * @return converted value */public static Object convertValue(final Object value, final Class&lt;?&gt; convertType) &#123; if (null == value) &#123; return convertNullValue(convertType); &#125; if (value.getClass() == convertType) &#123; return value; &#125; if (LocalDateTime.class.equals(convertType)) &#123; return convertLocalDateTimeValue(value, convertType); &#125; if (LocalDate.class.equals(convertType)) &#123; return convertLocalDateValue(value, convertType); &#125; if (LocalTime.class.equals(convertType)) &#123; return convertLocalTimeValue(value, convertType); &#125; if (value instanceof Number) &#123; return convertNumberValue(value, convertType); &#125; if (value instanceof Date) &#123; return convertDateValue(value, convertType); &#125; if (value instanceof byte[]) &#123; return convertByteArrayValue(value, convertType); &#125; if (String.class.equals(convertType)) &#123; return value.toString(); &#125; else &#123; return value; &#125;&#125;......private static Object convertLocalDateTimeValue(final Object value, final Class&lt;?&gt; convertType) &#123; Timestamp timestamp = (Timestamp) value; return timestamp.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();&#125;private static Object convertLocalDateValue(final Object value, final Class&lt;?&gt; convertType) &#123; Timestamp timestamp = (Timestamp) value; return timestamp.toInstant().atZone(ZoneId.systemDefault()).toLocalDate();&#125;private static Object convertLocalTimeValue(final Object value, final Class&lt;?&gt; convertType) &#123; Timestamp timestamp = (Timestamp) value; return timestamp.toInstant().atZone(ZoneId.systemDefault()).toLocalTime();&#125; 2ã€package org.apache.shardingsphere.shardingjdbc.jdbc.core.resultset; 123456789101112131415@Overridepublic &lt;T&gt; T getObject(final int columnIndex, final Class&lt;T&gt; type) throws SQLException &#123; if (LocalDateTime.class.equals(type) || LocalDate.class.equals(type) || LocalTime.class.equals(type)) &#123; return (T) ResultSetUtil.convertValue(mergeResultSet.getValue(columnIndex, Timestamp.class), type); &#125; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125;@Overridepublic &lt;T&gt; T getObject(final String columnLabel, final Class&lt;T&gt; type) throws SQLException &#123; if (LocalDateTime.class.equals(type) || LocalDate.class.equals(type) || LocalTime.class.equals(type)) &#123; return (T) ResultSetUtil.convertValue(mergeResultSet.getValue(columnLabel, Timestamp.class), type); &#125; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125; 3ã€package org.apache.shardingsphere.shardingjdbc.jdbc.core.resultset; 123456789101112131415@Overridepublic &lt;T&gt; T getObject(final int columnIndex, final Class&lt;T&gt; type) throws SQLException &#123; if (LocalDateTime.class.equals(type) || LocalDate.class.equals(type) || LocalTime.class.equals(type)) &#123; return (T) ResultSetUtil.convertValue(resultSet.getValue(columnIndex, Timestamp.class), type); &#125; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125;@Overridepublic &lt;T&gt; T getObject(final String columnLabel, final Class&lt;T&gt; type) throws SQLException &#123; if (LocalDateTime.class.equals(type) || LocalDate.class.equals(type) || LocalTime.class.equals(type)) &#123; return (T) ResultSetUtil.convertValue(resultSet.getValue(columnLabel, Timestamp.class), type); &#125; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125; 4ã€package org.apache.shardingsphere.shardingjdbc.jdbc.unsupported; 123456789@Overridepublic &lt;T&gt; T getObject(final int columnIndex, final Class&lt;T&gt; type) throws SQLException &#123; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125;@Overridepublic &lt;T&gt; T getObject(final String columnLabel, final Class&lt;T&gt; type) throws SQLException &#123; throw new SQLFeatureNotSupportedException(\"getObject with type\");&#125;","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"shardingsphere","slug":"shardingsphere","permalink":"https://github.com/weiecho/tags/shardingsphere/"},{"name":"spring","slug":"spring","permalink":"https://github.com/weiecho/tags/spring/"},{"name":"æ¶æ„è®¾è®¡","slug":"æ¶æ„è®¾è®¡","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"}]},{"title":"Sentinelç†”æ–­é™çº§","slug":"stu_1115","date":"2020-06-06T06:22:42.000Z","updated":"2020-07-03T06:01:01.495Z","comments":true,"path":"2020/06/06/stu_1115/","link":"","permalink":"https://github.com/weiecho/2020/06/06/stu_1115/","excerpt":"","text":"ç†”æ–­é™çº§ä¼šåœ¨è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçŠ¶æ€æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨è¶…æ—¶æˆ–å¼‚å¸¸æ¯”ä¾‹å‡é«˜ï¼‰ï¼Œå¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºè€Œå¯¼è‡´çº§è”é”™è¯¯ã€‚ é¡¹ç›®åœ°å€ï¼šsentinelæµæ§é˜²æŠ¤ é™¤æµé‡æ§åˆ¶ä»¥å¤–ï¼Œå¯¹è°ƒç”¨é“¾è·¯ä¸­ä¸ç¨³å®šçš„èµ„æºè¿›è¡Œç†”æ–­é™çº§ä¹Ÿæ˜¯ä¿éšœé«˜å¯ç”¨çš„é‡è¦æªæ–½ä¹‹ä¸€ã€‚ ç”±äºè°ƒç”¨å…³ç³»çš„å¤æ‚æ€§ï¼Œå¦‚æœè°ƒç”¨é“¾è·¯ä¸­çš„æŸä¸ªèµ„æºä¸ç¨³å®šï¼Œæœ€ç»ˆä¼šå¯¼è‡´è¯·æ±‚å‘ç”Ÿå †ç§¯ã€‚ç†”æ–­é™çº§ä¼šåœ¨è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçŠ¶æ€æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨è¶…æ—¶æˆ–å¼‚å¸¸æ¯”ä¾‹å‡é«˜ï¼‰ï¼Œå¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºè€Œå¯¼è‡´çº§è”é”™è¯¯ã€‚ Sentinel ç†”æ–­é™çº§æ”¯æŒä»¥ä¸‹å‡ ç§ç­–ç•¥ï¼š RT æ¨¡å¼ï¼ˆç§’çº§ï¼‰ï¼šè‹¥æŒç»­è¿›å…¥ 5 ä¸ªè¯·æ±‚ï¼Œå®ƒä»¬èµ„æºçš„å¹³å‡å“åº”æ—¶é—´éƒ½è¶…è¿‡é˜ˆå€¼ï¼ˆç§’çº§å¹³å‡ RTï¼Œä»¥ ms ä¸ºå•ä½ï¼‰ï¼Œèµ„æºè°ƒç”¨ä¼šè¢«ç†”æ–­ã€‚åœ¨æ¥ä¸‹çš„é™çº§æ—¶é—´çª—å£ï¼ˆåœ¨é™çº§è§„åˆ™ä¸­é…ç½®ï¼Œä»¥ s ä¸ºå•ä½ï¼‰ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°è¿”å›ï¼ˆæŠ›å‡º DegradeExceptionï¼‰ã€‚ å¼‚å¸¸æ¯”ä¾‹æ¨¡å¼ï¼ˆç§’çº§ï¼‰ï¼šå½“èµ„æºçš„æ¯ç§’å¼‚å¸¸æ•°å é€šè¿‡é‡çš„æ¯”å€¼è¶…è¿‡é˜ˆå€¼ä¹‹åï¼Œèµ„æºè¿›å…¥é™çº§çŠ¶æ€ï¼Œå³åœ¨æ¥ä¸‹çš„é™çº§æ—¶é—´çª—å£ï¼ˆåœ¨é™çº§è§„åˆ™ä¸­é…ç½®ï¼Œä»¥ s ä¸ºå•ä½ï¼‰ï¼‰ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°è¿”å›ã€‚å¼‚å¸¸æ¯”ç‡çš„é˜ˆå€¼èŒƒå›´æ˜¯ [0.0, 1.0]ï¼Œä»£è¡¨ 0% - 100%ã€‚ å¼‚å¸¸æ•°æ¨¡å¼ï¼ˆåˆ†é’Ÿçº§ï¼‰ï¼šå½“èµ„æºæœ€è¿‘ 1 åˆ†é’Ÿçš„å¼‚å¸¸æ•°ç›®è¶…è¿‡é˜ˆå€¼ä¹‹åä¼šè¿›è¡Œç†”æ–­ã€‚","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"æµæ§é™çº§","slug":"æµæ§é™çº§","permalink":"https://github.com/weiecho/tags/%E6%B5%81%E6%8E%A7%E9%99%8D%E7%BA%A7/"},{"name":"sentinel","slug":"sentinel","permalink":"https://github.com/weiecho/tags/sentinel/"}]},{"title":"Sentinelæµé‡æ§åˆ¶ï¼ˆé™æµï¼‰","slug":"stu_1114","date":"2020-05-25T05:18:42.000Z","updated":"2020-07-03T03:24:54.203Z","comments":true,"path":"2020/05/25/stu_1114/","link":"","permalink":"https://github.com/weiecho/2020/05/25/stu_1114/","excerpt":"","text":"æµæ§ï¼Œå³æµé‡æ§åˆ¶ï¼ˆFlow Controlï¼‰ï¼Œæ ¹æ®æµé‡ã€å¹¶å‘çº¿ç¨‹æ•°ã€å“åº”æ—¶é—´ç­‰æŒ‡æ ‡ï¼ŒæŠŠéšæœºåˆ°æ¥çš„æµé‡è°ƒæ•´æˆåˆé€‚çš„å½¢çŠ¶ï¼Œå³æµé‡å¡‘å½¢ã€‚é¿å…åº”ç”¨è¢«ç¬æ—¶çš„æµé‡é«˜å³°å†²å®ï¼Œä»è€Œä¿éšœåº”ç”¨çš„é«˜å¯ç”¨æ€§ã€‚ é¡¹ç›®åœ°å€ï¼šsentinelæµæ§é˜²æŠ¤ æµé‡æ§åˆ¶æœ‰ä»¥ä¸‹å‡ ä¸ªè§’åº¦:è¿è¡ŒæŒ‡æ ‡ï¼Œä¾‹å¦‚ QPSã€å¹¶å‘çº¿ç¨‹æ•°ç­‰ã€‚ èµ„æºçš„è°ƒç”¨å…³ç³»ï¼Œä¾‹å¦‚èµ„æºçš„è°ƒç”¨é“¾è·¯ï¼Œèµ„æºå’Œèµ„æºä¹‹é—´çš„å…³ç³»ï¼Œè°ƒç”¨æ¥æºç­‰ã€‚ æ§åˆ¶æ•ˆæœï¼Œä¾‹å¦‚ç›´æ¥æ‹’ç»ã€Warm Upï¼ˆé¢„çƒ­ï¼‰ã€æ’é˜Ÿç­‰å¾…ç­‰ã€‚ ä¸€æ¡æµæ§è§„åˆ™ä¸»è¦ç”±ä¸‹é¢å‡ ä¸ªå› ç´ ç»„æˆï¼Œæˆ‘ä»¬å¯ä»¥ç»„åˆè¿™äº›å…ƒç´ æ¥å®ç°ä¸åŒçš„é™æµæ•ˆæœï¼š èµ„æºåï¼šå³æµæ§è§„åˆ™çš„ä½œç”¨å¯¹è±¡ é˜ˆå€¼ï¼šæµæ§é˜ˆå€¼ é˜ˆå€¼ç±»å‹ï¼šæµæ§é˜ˆå€¼ç±»å‹ï¼ˆQPS æˆ–å¹¶å‘çº¿ç¨‹æ•°ï¼‰ æ¥æºåº”ç”¨ï¼šæµæ§è§„åˆ™é’ˆå¯¹çš„è°ƒç”¨æ¥æºï¼Œè‹¥ä¸º default åˆ™ä¸åŒºåˆ†è°ƒç”¨æ¥æº æµæ§æ–¹å¼ï¼šè°ƒç”¨å…³ç³»é™æµç­–ç•¥ æµæ§æ¨¡å¼ï¼šå³æµæ§æ•ˆæœï¼ŒåŒ…æ‹¬å¿«é€Ÿå¤±è´¥ã€Warm Upã€æ’é˜Ÿç­‰å¾…æ¨¡å¼ è¿è¡ŒæŒ‡æ ‡æµé‡æ§åˆ¶æ”¯æŒé€šè¿‡ä»¥ä¸‹è¿è¡ŒæŒ‡æ ‡è¿›è¡Œæµé‡å¡‘å½¢ï¼š åŸºäº QPSQPS æ¨¡å¼æ ¹æ®èµ„æºçš„å®æ—¶ QPS è¿›è¡Œæµé‡æ§åˆ¶ã€‚å½“ QPS è¶…è¿‡æŒ‡å®šé˜ˆå€¼æ—¶é‡‡å–ç›¸åº”çš„æ§åˆ¶ç­–ç•¥ã€‚ åŸºäºçº¿ç¨‹æ•°çº¿ç¨‹æ•°æ¨¡å¼æŒ‰ç…§èµ„æºçš„å¹¶å‘çº¿ç¨‹æ•°ï¼ˆå³è¯¥èµ„æºæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æ•°ï¼‰è¿›è¡Œæµé‡æ§åˆ¶ã€‚ å¹¶å‘çº¿ç¨‹æ•°é™æµç”¨äºä¿æŠ¤ä¸šåŠ¡çº¿ç¨‹æ•°ä¸è¢«è€—å°½ã€‚ä¾‹å¦‚ï¼Œå½“åº”ç”¨æ‰€ä¾èµ–çš„ä¸‹æ¸¸åº”ç”¨ç”±äºæŸç§åŸå› å¯¼è‡´æœåŠ¡ä¸ç¨³å®šã€å“åº”å»¶è¿Ÿå¢åŠ ï¼Œå¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œæ„å‘³ç€ååé‡ä¸‹é™å’Œæ›´å¤šçš„çº¿ç¨‹æ•°å ç”¨ï¼Œæç«¯æƒ…å†µä¸‹ç”šè‡³å¯¼è‡´çº¿ç¨‹æ± è€—å°½ã€‚ä¸ºåº”å¯¹å¤ªå¤šçº¿ç¨‹å ç”¨çš„æƒ…å†µï¼Œä¸šå†…æœ‰ä½¿ç”¨éš”ç¦»çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚é€šè¿‡ä¸åŒä¸šåŠ¡é€»è¾‘ä½¿ç”¨ä¸åŒçº¿ç¨‹æ± æ¥éš”ç¦»ä¸šåŠ¡è‡ªèº«ä¹‹é—´çš„èµ„æºäº‰æŠ¢ï¼ˆçº¿ç¨‹æ± éš”ç¦»ï¼‰ã€‚è¿™ç§éš”ç¦»æ–¹æ¡ˆè™½ç„¶éš”ç¦»æ€§æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯ä»£ä»·å°±æ˜¯çº¿ç¨‹æ•°ç›®å¤ªå¤šï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ overhead æ¯”è¾ƒå¤§ï¼Œç‰¹åˆ«æ˜¯å¯¹ä½å»¶æ—¶çš„è°ƒç”¨æœ‰æ¯”è¾ƒå¤§çš„å½±å“ã€‚Sentinel å¹¶å‘çº¿ç¨‹æ•°é™æµä¸è´Ÿè´£åˆ›å»ºå’Œç®¡ç†çº¿ç¨‹æ± ï¼Œè€Œæ˜¯ç®€å•ç»Ÿè®¡å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡çš„çº¿ç¨‹æ•°ç›®ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼ï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ•ˆæœç±»ä¼¼äºä¿¡å·é‡éš”ç¦»ã€‚ æ§åˆ¶æ•ˆæœæµæ§æ–¹å¼ï¼ˆæ§åˆ¶æ•ˆæœï¼‰æŒ‡çš„æ˜¯ï¼Œå½“é˜ˆå€¼ç±»å‹ä¸º QPS æ—¶ï¼Œé€‰æ‹©å¦‚ä½•æ§åˆ¶æµé‡ï¼Œå¤„ç†è¢«æ‹¦æˆªçš„æµé‡ï¼Œå®ç°æµé‡å¡‘å½¢ã€‚æµé‡æ§åˆ¶çš„æ‰‹æ®µåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼šå¿«é€Ÿå¤±è´¥ã€Warm Upã€æ’é˜Ÿç­‰å¾…ã€‚ è¯´æ˜ æ§åˆ¶æ•ˆæœä»…å¯¹ QPS é™æµç”Ÿæ•ˆã€‚ å¿«é€Ÿå¤±è´¥å¿«é€Ÿå¤±è´¥æ–¹å¼æ˜¯é»˜è®¤çš„æµé‡æ§åˆ¶æ–¹å¼ï¼Œå½“ QPS è¶…è¿‡è§„åˆ™çš„é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ‹’ç»æ–¹å¼ä¸ºæŠ›å‡º FlowExceptionã€‚è¿™ç§æ–¹å¼é€‚ç”¨äºå¯¹ç³»ç»Ÿå¤„ç†èƒ½åŠ›ç¡®åˆ‡å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚é€šè¿‡å‹æµ‹ç¡®å®šäº†ç³»ç»Ÿçš„å‡†ç¡®æ°´ä½æ—¶ã€‚ Warm Upå½“ç³»ç»Ÿé•¿æœŸå¤„äºç©ºé—²çš„æƒ…å†µä¸‹ï¼Œå½“æµé‡çªç„¶å¢åŠ æ—¶ï¼Œç›´æ¥æŠŠç³»ç»Ÿæ‹‰å‡åˆ°é«˜æ°´ä½å¯èƒ½ç¬é—´æŠŠç³»ç»Ÿå‹å®ã€‚é€šè¿‡ Warm Up æ¨¡å¼ï¼ˆé¢„çƒ­æ¨¡å¼ï¼‰ï¼Œè®©é€šè¿‡çš„æµé‡ç¼“æ…¢å¢åŠ ï¼Œç»è¿‡è®¾ç½®çš„é¢„çƒ­æ—¶é—´ä»¥åï¼Œåˆ°è¾¾ç³»ç»Ÿå¤„ç†è¯·æ±‚é€Ÿç‡çš„è®¾å®šå€¼ã€‚ Warm Up æ¨¡å¼é»˜è®¤ä¼šä»è®¾ç½®çš„ QPS é˜ˆå€¼çš„ 1/3 å¼€å§‹æ…¢æ…¢å¾€ä¸Šå¢åŠ è‡³ QPS è®¾ç½®å€¼ã€‚ æ’é˜Ÿç­‰å¾…æ’é˜Ÿç­‰å¾…æ¨¡å¼ä¸‹ä¼šä¸¥æ ¼æ§åˆ¶è¯·æ±‚é€šè¿‡çš„é—´éš”æ—¶é—´ï¼Œå³è¯·æ±‚ä¼šåŒ€é€Ÿé€šè¿‡ï¼Œå…è®¸éƒ¨åˆ†è¯·æ±‚æ’é˜Ÿç­‰å¾…ï¼Œé€šå¸¸ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—å‰Šå³°å¡«è°·ç­‰åœºæ™¯ã€‚éœ€è®¾ç½®å…·ä½“çš„è¶…æ—¶æ—¶é—´ï¼Œå½“è®¡ç®—çš„ç­‰å¾…æ—¶é—´è¶…è¿‡è¶…æ—¶æ—¶é—´æ—¶è¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚ ä¾‹å¦‚ï¼ŒQPS é…ç½®ä¸º 5ï¼Œåˆ™ä»£è¡¨è¯·æ±‚æ¯ 200 ms æ‰èƒ½é€šè¿‡ä¸€ä¸ªï¼Œå¤šå‡ºçš„è¯·æ±‚å°†æ’é˜Ÿç­‰å¾…é€šè¿‡ã€‚è¶…æ—¶æ—¶é—´ä»£è¡¨æœ€å¤§æ’é˜Ÿæ—¶é—´ï¼Œè¶…å‡ºæœ€å¤§æ’é˜Ÿæ—¶é—´çš„è¯·æ±‚å°†ä¼šç›´æ¥è¢«æ‹’ç»ã€‚æ’é˜Ÿç­‰å¾…æ¨¡å¼ä¸‹ï¼ŒQPS è®¾ç½®å€¼ä¸è¦è¶…è¿‡ 1000ï¼ˆè¯·æ±‚é—´éš” 1 msï¼‰ã€‚ æ’é˜Ÿç­‰å¾…","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"æµæ§é™çº§","slug":"æµæ§é™çº§","permalink":"https://github.com/weiecho/tags/%E6%B5%81%E6%8E%A7%E9%99%8D%E7%BA%A7/"},{"name":"sentinel","slug":"sentinel","permalink":"https://github.com/weiecho/tags/sentinel/"}]},{"title":"Sentinelæµæ§é™çº§å¿«é€Ÿå…¥é—¨","slug":"stu_1113","date":"2020-05-02T04:18:12.000Z","updated":"2020-07-03T03:25:00.915Z","comments":true,"path":"2020/05/02/stu_1113/","link":"","permalink":"https://github.com/weiecho/2020/05/02/stu_1113/","excerpt":"","text":"Sentinelä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥å¸®åŠ©æ‚¨ä¿éšœæœåŠ¡çš„ç¨³å®šæ€§ï¼Œæä¾›æ›´ä¸“ä¸šç¨³å®šçš„æµé‡é˜²æŠ¤æ‰‹æ®µã€ç§’çº§çš„æµé‡æ°´ä½åˆ†å¸ƒåˆ†æåŠŸèƒ½ã€‚ é¡¹ç›®åœ°å€ï¼šsentinelæµæ§é˜²æŠ¤ ä½¿ç”¨åœºæ™¯Sentinelå¹¿æ³›ç”¨äºç§’æ€åœºæ™¯ã€æ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ç­‰åœºæ™¯ä¸­ï¼Œä»å¤šä¸ªç»´åº¦ä¿éšœæ‚¨çš„ä¸šåŠ¡ç¨³å®šæ€§ã€‚ åœ¨ä¸€ä¸ªå¸¸è§çš„åˆ†å¸ƒå¼åº”ç”¨ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸€ä¸ªè¯·æ±‚å…ˆé€šè¿‡ç»ˆç«¯åˆ°è¾¾ Gatewayï¼Œå†ç»è¿‡é˜²ç«å¢™å’Œç½‘ç»œè´Ÿè½½å‡è¡¡ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬è°ƒç”¨ä¸‹æ¸¸çš„å…¶å®ƒæœåŠ¡å’Œç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œæ‰èƒ½åˆ°è¾¾å‰ç«¯ç½‘ç»œæœåŠ¡ã€‚AHAS åº”ç”¨æµæ§é™çº§åœ¨ä¸åŒçš„å±‚æ¬¡ä»¥æµé‡ä¸ºåˆ‡é¢æä¾›ç§’çº§å®æ—¶çš„æµé‡åˆ†æï¼ˆä¾‹å¦‚åœ¨å®¢æˆ·ç«¯å±‚æä¾›æµé‡å®æ—¶ç›‘æ§å’Œæ°´ä½è¯Šæ–­åˆ†æåŠŸèƒ½ï¼‰ï¼Œå¸®åŠ©è¿ç»´äººå‘˜é‡‡å–é’ˆå¯¹æ€§çš„é˜²æŠ¤æªæ–½ï¼Œå…¨æ–¹ä½åœ°ä¿æŠ¤åº”ç”¨çš„ç¨³å®šæ€§ã€‚ SentinelæœåŠ¡ åŠŸèƒ½ç‰¹æ€§ç§’çº§æµé‡åˆ†æåŠŸèƒ½ï¼ŒåŠ¨æ€è§„åˆ™å®æ—¶æ¨é€ã€‚ä¸“ä¸šå¤šæ ·åŒ–çš„é˜²æŠ¤æ‰‹æ®µï¼š å…¥å£æµé‡æ§åˆ¶ï¼šæŒ‰ç…§æœåŠ¡å®¹é‡è¿›è¡Œæµé‡æ§åˆ¶ï¼Œå¸¸ç”¨äºåº”ç”¨å…¥å£ï¼Œä¾‹å¦‚ï¼š Gatewayã€å‰ç«¯åº”ç”¨ã€æœåŠ¡æä¾›æ–¹ç­‰ã€‚ çƒ­ç‚¹éš”ç¦»ï¼šå°†çƒ­ç‚¹å’Œæ™®é€šæµé‡éš”ç¦»å‡ºæ¥ï¼Œé¿å…æ— æ•ˆçƒ­ç‚¹æŠ¢å æ­£å¸¸æµé‡çš„å®¹é‡ã€‚ å¯¹ä¾èµ–æ–¹éš”ç¦» / é™çº§ï¼šå¯¹åº”ç”¨å’Œåº”ç”¨ä¹‹é—´ã€åº”ç”¨å†…éƒ¨é‡‡ç”¨éš”ç¦» / é™çº§æ‰‹æ®µï¼Œå°†ä¸ç¨³å®šçš„ä¾èµ–çš„å¯¹åº”ç”¨çš„å½±å“å‡è‡³æœ€å°ï¼Œä»è€Œä¿è¯åº”ç”¨çš„ç¨³å®šæ€§ã€‚ ç³»ç»Ÿé˜²æŠ¤ï¼šSentinelå¯ä»¥æ ¹æ®ç³»ç»Ÿçš„èƒ½åŠ›ï¼ˆä¾‹å¦‚ Loadã€CPU ä½¿ç”¨ç‡ç­‰ï¼‰æ¥åŠ¨æ€è°ƒèŠ‚å…¥å£çš„æµé‡ï¼Œä¿è¯ç³»ç»Ÿç¨³å®šæ€§ã€‚å®æ—¶çš„å•æœºç›‘æ§èƒ½åŠ›ï¼Œå¼ºå¤§çš„èšåˆç›‘æ§å’Œå†å²ç›‘æ§æŸ¥è¯¢èƒ½åŠ›ã€‚","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"æµæ§é™çº§","slug":"æµæ§é™çº§","permalink":"https://github.com/weiecho/tags/%E6%B5%81%E6%8E%A7%E9%99%8D%E7%BA%A7/"},{"name":"sentinel","slug":"sentinel","permalink":"https://github.com/weiecho/tags/sentinel/"}]},{"title":"Sharding-dbæ¥å…¥ä½¿ç”¨è¯´æ˜","slug":"doc_1113","date":"2020-03-02T04:26:35.000Z","updated":"2020-07-03T03:09:12.316Z","comments":true,"path":"2020/03/02/doc_1113/","link":"","permalink":"https://github.com/weiecho/2020/03/02/doc_1113/","excerpt":"","text":"ShardingSphereæ˜¯å¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆç»„æˆçš„ç”Ÿæ€åœˆï¼Œç”±Sharding-jdbcã€Sharding-Proxyç­‰ç»„æˆï¼Œæä¾›æ ‡å‡†åŒ–çš„æ•°æ®åˆ†ç‰‡ã€å®‰å…¨æ§åˆ¶ã€åˆ†å¸ƒå¼äº‹åŠ¡å’Œæ•°æ®åº“æ²»ç†åŠŸèƒ½ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»sharding-dbåœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨ã€‚ Sharding-dbæ˜¯å¯¹Sharding-jdbcçš„åŠŸèƒ½å°è£…ï¼Œæ–¹ä¾¿åŠŸèƒ½çš„å¯¹æ¥ï¼Œç»Ÿä¸€é¡¹ç›®å›¢é˜Ÿå¯¹æ•°æ®æºçš„å¯¹æ¥ é¡¹ç›®åœ°å€ï¼šsharding-db Sharding-jdbcåˆ†ç‰‡è¿‡ç¨‹ Sharding-jdbcæ ¹æ®SQLè¯­å¥è¿›è¡Œè¯è¯­è§£æï¼Œä¸Šä¸‹æ–‡åŒ¹é…æ•°æ®åº“å’Œè¡¨çš„åˆ†ç‰‡ç­–ç•¥ç”Ÿæˆè·¯ç”±è·¯å¾„ï¼Œå°†åˆ†è¡¨é…ç½®ä¸­çš„é€»è¾‘åº“è¡¨æ”¹å†™ä¸ºçœŸå®åº“è¡¨SQLè¯­å¥ï¼Œå‘é€åˆ°åº•å±‚æ•°æ®æºæ‰§è¡Œï¼Œå°†ä»å„ä¸ªæ•°æ®èŠ‚ç‚¹è·å–çš„å¤šæ•°æ®ç»“æœé›†ï¼Œç»„åˆæˆä¸ºä¸€ä¸ªç»“æœé›†å¹¶æ­£ç¡®çš„è¿”å›è‡³è¯·æ±‚å®¢æˆ·ç«¯ã€‚ POMé…ç½® 12345&lt;dependency&gt; &lt;groupId&gt;cn.weiecho&lt;/groupId&gt; &lt;artifactId&gt;sharding-db&lt;/artifactId&gt; &lt;version&gt;1.0.3&lt;/version&gt;&lt;/dependency&gt; Databaseé…ç½®123456789101112131415161718//å•æ•°æ®æºæ¨¡å¼@Configurationpublic class DatabaseConfig extends DatabaseSingletonConfigurator &#123;&#125;//ä¸»ä»æ•°æ®æºæ¨¡å¼@Configurationpublic class DatabaseConfig extends DatabaseMasterSlaveConfigurator &#123;&#125;//åˆ†è¡¨æ•°æ®æºæ¨¡å¼@Configurationpublic class DatabaseConfig extends DatabaseShardingConfigurator &#123;&#125; é…ç½®æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738sharding.jdbc: default-data-source-name: ms_ds_0 data-sources: ds_master: driver-class-name: com.mysql.cj.jdbc.Driver type: com.zaxxer.hikari.HikariDataSource jdbc-url: jdbc:mysql://127.0.0.1:3306/test_db?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull username: root password: root initial-size: 1 minimum-idle: 3 maximum-pool-size: 20 idle-timeout: 60000 max-lifetime: 180000 connection-test-query: select 1 test-while-idle: true test-on-borrow: true connection-init-sql: set names utf8mb4 ds_slave: driver-class-name: com.mysql.cj.jdbc.Driver type: com.zaxxer.hikari.HikariDataSource jdbc-url: jdbc:mysql://127.0.0.1:3307/test_db?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull username: root password: root initial-size: 1 minimum-idle: 3 maximum-pool-size: 20 idle-timeout: 60000 max-lifetime: 180000 connection-test-query: select 1 test-while-idle: true test-on-borrow: true connection-init-sql: set names utf8mb4 master-slave-rules: - name: ms_ds_0 master-data-source-name: ds_master slave-data-source-names: ds_slave load-balance-strategy: round_robin åˆ†è¡¨ç­–ç•¥é…ç½®é‡å†™DatabaseShardingConfigurator çš„åˆ†è¡¨ç­–ç•¥å®ç°ç›¸å…³åŠŸèƒ½ 1234567891011121314/** * é…ç½®åˆ†è¡¨ç­–ç•¥TableRule */public Collection&lt;TableRuleConfiguration&gt; tableRuleConfigs() &#123; return Collections.emptyList();&#125;/** * é…ç½®ç»‘å®šè¡¨åˆ†ç»„BindingTable * å…³è”å¤šè¡¨æŸ¥è¯¢çš„æ—¶å€™é¿å…ç¬›å¡å°”ç§¯çš„ç»„åˆå‡ºç° */public Collection&lt;String&gt; bindingTableGroups() &#123; return Collections.emptyList();&#125; æ•°æ®å®‰å…¨é…ç½®ï¼ˆè„±æ•ï¼‰æ•æ„Ÿæ•°æ®è„±æ•ï¼Œé‡å†™DatabaseShardingConfiguratorçš„åŠ å¯†è§„åˆ™å®ç°ç›¸å…³åŠŸèƒ½ 1234567/** * æ•°æ®è„±æ•ç­–ç•¥EncryptRule */public EncryptRuleConfiguration encryptRuleConfig() &#123; return null;&#125; å¹¿æ’­è¡¨ç­–ç•¥ç”¨äºæ•°æ®æºåˆ†ç‰‡ä¸‹ï¼Œæ¯ä¸ªæ•°æ®æºéƒ½ä¿å­˜ç›¸åŒè¡¨å…¨é‡æ•°æ®ï¼Œå¦‚å­—å…¸è¡¨ï¼Œé…ç½®è¡¨ç­‰ 12345678/** * é…ç½®å¹¿æ’­è¡¨åˆ—è¡¨BroadcastTables * */public Collection&lt;String&gt; broadcastTables() &#123; return Collections.emptyList();&#125; å¼ºåˆ¶è·¯ç”±è‡³ä¸»åº“12HintManager hintManager = HintManager.getInstance();hintManager.setMasterRouteOnly(); æ¨èä½¿ç”¨try with resourceæ–¹å¼ 1234try (HintManager hintManager = HintManager.getInstance()) &#123; hintManager.setMasterRouteOnly();&#125; å¼ºåˆ¶è·¯ç”±è‡³æŒ‡å®šè¯»åº“12HintManager hintManager = HintManager.getInstance();hintManager.setDatabaseShardingValue(1); æ¨èä½¿ç”¨try with resourceæ–¹å¼ 1234try (HintManager hintManager = HintManager.getInstance()) &#123; hintManager.setDatabaseShardingValue(1);&#125;","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"æ•°æ®æº","slug":"æ•°æ®æº","permalink":"https://github.com/weiecho/tags/%E6%95%B0%E6%8D%AE%E6%BA%90/"},{"name":"åˆ†åº“åˆ†è¡¨","slug":"åˆ†åº“åˆ†è¡¨","permalink":"https://github.com/weiecho/tags/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/"},{"name":"shardingsphere","slug":"shardingsphere","permalink":"https://github.com/weiecho/tags/shardingsphere/"}]},{"title":"ä¿®å¤shardingsphere-4.0.0ä¸èƒ½æ­£å¸¸é…ç½®é—®é¢˜","slug":"exp_1115","date":"2019-12-10T13:21:36.000Z","updated":"2020-07-03T06:00:06.402Z","comments":true,"path":"2019/12/10/exp_1115/","link":"","permalink":"https://github.com/weiecho/2019/12/10/exp_1115/","excerpt":"","text":"ç›®å‰å®˜æ–¹å·²ç»é‚€è¯·æˆ‘è°ƒæ•´äº†è¯´æ˜æ–‡æ¡£ï¼Œæ–‡æ¡£å·²ç»å’Œæœ€æ–°ä»£ç ä¸€è‡´ï¼ å¦‚æœæ‚¨å‡†å¤‡è‡ªå·±è°ƒæ•´é…ç½®æ³¨å…¥æ–¹å¼ï¼Œå¯ä»¥å‚è€ƒæœ¬æ¬¡ä¿®å¤è¿‡ç¨‹ã€‚ Sharingsphereåœ¨æ ¹æ®å®˜æ–¹é…ç½®ä¸ºMaster-slave rule configurationæ¨¡å¼æ—¶å¯åŠ¨ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š Master-slave åŸå› åœ¨4.0.0-xç‰ˆæœ¬ä¸­ï¼Œå°†ä»£ç è¿ç§»è‡³apacheæ—¶ï¼Œå°ä¼™ä¼´å‚²å¨‡çš„å°†å‚æ•°å®ç°æ”¹æˆäº†å¦‚ä¸‹ï¼ŒåŒæ—¶æ²¡æœ‰äº†æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ æ–°ç‰ˆæœ¬MasterSlaveRuleConfigurationä»£ç  å†çœ‹çœ‹3.0.xåŸç‰ˆçš„æ—§ä»£ç å®ç°çŠ¶å†µ æ—§ç‰ˆæœ¬MasterSlaveRuleConfigurationä»£ç  å®˜æ–¹ç¤ºä¾‹å±…ç„¶è¿˜æœ‰æ— å‚æ•°åˆ›å»ºçš„ç¤ºä¾‹ï¼Œè¯•é—®æ˜¯æ€ä¹ˆåšåˆ°çš„ shardingsphereå®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ ä»è¿™ç‚¹çœ‹æœ‰è¢«æ”¹å†™å¿½ç•¥çš„é—®é¢˜ï¼ŒåŒæ—¶æŒ‰ç…§å®˜æ–¹é…ç½®ï¼Œå‡ºç°å¦‚ä¸Šçš„é…ç½®å¯åŠ¨æŠ¥é”™é—®é¢˜ï¼ï¼ï¼ æˆ‘æ˜¯çŠ€åˆ©çš„åˆ†å‰²çº¿ â€”- ä¸‹é¢æ˜¯ç¡¬å†™è§£å†³æ–¹æ¡ˆ åˆ›å»ºæ–°ç±»MasterSlaveRuleConfig.javaï¼Œå¤åˆ¶å®˜æ–¹æ–°ç‰ˆæœ¬MasterSlaveRuleConfigurationï¼Œæ”¹ä¸ºå¦‚ä¸‹ï¼š æ”¹å†™MasterSlaveRuleConfiguration 1ã€@Getteræ”¹ä¸º@Dataï¼Œæ”¯æŒé…ç½®è¯»å†™ 2ã€å»æ‰å†…éƒ¨privateå¯¹è±¡çš„finalé™å®š 3ã€åŠ å…¥MasterSlaveRuleConfigurationæ— å‚æ•°æ„é€ å‡½æ•° é…ç½®æ”¹é€ å®Œæˆï¼Œä¸‹é¢æ˜¯è°ƒæ•´é…ç½®å‡½æ•°ï¼š é‡å†™é…ç½®MasterSlaveRuleConfiguration MasterSlaveRuleConfigé…ç½®åœ¨ sharding.master-slave-rule ä¸‹é¢ï¼Œå’Œå®˜æ–¹ä¸€è‡´ã€‚ æœåŠ¡å¯åŠ¨ï½ï½ï½ï½ï½ happy time ğŸ˜„","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"shardingsphere","slug":"shardingsphere","permalink":"https://github.com/weiecho/tags/shardingsphere/"},{"name":"spring","slug":"spring","permalink":"https://github.com/weiecho/tags/spring/"},{"name":"æ¶æ„è®¾è®¡","slug":"æ¶æ„è®¾è®¡","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"}]},{"title":"lemon-rabbitmqå®ç°rabbitMQçš„è§£è€¦æ–¹å¼","slug":"doc_1111","date":"2019-12-02T02:34:12.000Z","updated":"2020-07-08T03:16:30.613Z","comments":true,"path":"2019/12/02/doc_1111/","link":"","permalink":"https://github.com/weiecho/2019/12/02/doc_1111/","excerpt":"","text":"é¡¹ç›®åœ°å€ï¼šlemon-rabbitmq lemon-rabbitmq æ¶ˆæ¯ç”Ÿäº§ç«¯ lemon-rabbitmq-protocol æ¶ˆæ¯åè®®å±‚ lemon-rabbitmq-consumer æ¶ˆæ¯æ¶ˆè´¹ç«¯ æ¶ˆæ¯åè®®å±‚é€šè¿‡Jackson2åºåˆ—åŒ–/ååºåˆ—åŒ–ï¼Œå®ç°æ¶ˆæ¯ä¼ é€’å’Œå¯¹è±¡æ¥æ”¶ æ¶ˆæ¯ç”Ÿäº§ç«¯1ã€é€šè¿‡å‘é€å¸¦æœ‰æ¶ˆè´¹ç«¯æœåŠ¡ç±»åç§°å’Œæ–¹æ³•è¯·æ±‚å¤´ï¼Œæ§åˆ¶æ¶ˆè´¹ç«¯è°ƒç”¨æ‰§è¡Œæ¶ˆè´¹å‘é€çš„ä¿¡æ¯ 2ã€åˆ©ç”¨æ¶ˆæ¯å›è°ƒæ¥å£ConfirmCallbackç¡®ä¿æ¶ˆæ¯å®‰å…¨å‘é€è‡³brokeræœåŠ¡å™¨ï¼Œå¤„ç†æ•ˆç‡æ¯”äº‹ç‰©æ–¹å¼æ›´é«˜ 1234567891011121314151617public void sendMessage(final String serviceName, final String serviceMethodName,final String correlationId, Object request) &#123; logger.info(\"sendMessage [this.&#123;&#125;, serviceMethodName:&#123;&#125; serviceName:&#123;&#125; correlationId: &#123;&#125;]\", this.getClass(), serviceMethodName, serviceName, correlationId); rabbitTemplate.setConfirmCallback(this); rabbitTemplate.setCorrelationKey(correlationId); rabbitTemplate.convertAndSend(routingkey, request, new MessagePostProcessor() &#123; @Override public Message postProcessMessage(Message message) throws AmqpException &#123; message.getMessageProperties().setAppId(appId); message.getMessageProperties().setTimestamp(new Date()); message.getMessageProperties().setMessageId(UUID.randomUUID().toString()); message.getMessageProperties().setCorrelationId(correlationId.getBytes()); message.getMessageProperties().setHeader(\"ServiceMethodName\", serviceMethodName); message.getMessageProperties().setHeader(\"ServiceName\", serviceName); return message; &#125; &#125;, new CorrelationData(correlationId));&#125; æ¶ˆæ¯æ¶ˆè´¹ç«¯1ã€ç›‘å¬MQæ¶ˆæ¯ï¼Œåˆ©ç”¨method.invokeè°ƒç”¨æŒ‡å®šçš„æœåŠ¡ç±»åç§°å’Œæ–¹æ³•ï¼Œæ¶ˆè´¹æ¥æ”¶åˆ°çš„æ¶ˆæ¯ 2ã€ä½¿ç”¨Ack/Nackæ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯å¤„ç†çŠ¶æ€ï¼Œä¿è¯brokeræ¶ˆæ¯è¢«æ­£ç¡®æ¶ˆè´¹ 12345678910111213141516171819public void onMessage(Message message, Channel channel) throws IOException &#123; System.out.println(\"----- received\" + message.getMessageProperties()); try &#123; Object msg = messageConverter.fromMessage(message); if (!appId.equals(message.getMessageProperties().getAppId()))&#123; channel.basicNack(message.getMessageProperties().getDeliveryTag(), false, false); throw new SecurityException(\"éæ³•åº”ç”¨appId:\" + message.getMessageProperties().getAppId()); &#125; Object service = ctx.getBean(message.getMessageProperties().getHeaders().get(\"ServiceName\").toString()); String serviceMethodName = message.getMessageProperties().getHeaders().get(\"ServiceMethodName\").toString(); Method method = service.getClass().getMethod(serviceMethodName, msg.getClass()); method.invoke(service, msg); //ç¡®è®¤æ¶ˆæ¯æˆåŠŸæ¶ˆè´¹ channel.basicAck(message.getMessageProperties().getDeliveryTag(), false); &#125; catch (NoSuchMethodException | SecurityException | IllegalAccessException | IllegalArgumentException | InvocationTargetException e) &#123; System.out.println(\"------ err\"+ e.getMessage()); channel.basicNack(message.getMessageProperties().getDeliveryTag(), false, false); &#125;&#125;","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"springboot","slug":"springboot","permalink":"https://github.com/weiecho/tags/springboot/"},{"name":"mq","slug":"mq","permalink":"https://github.com/weiecho/tags/mq/"},{"name":"ack/nack","slug":"ack-nack","permalink":"https://github.com/weiecho/tags/ack-nack/"}]},{"title":"ä»£ç ä¹ æƒ¯åœ¨ç»†èŠ‚","slug":"exp_1112","date":"2019-11-05T07:12:12.000Z","updated":"2020-07-03T02:04:19.223Z","comments":true,"path":"2019/11/05/exp_1112/","link":"","permalink":"https://github.com/weiecho/2019/11/05/exp_1112/","excerpt":"","text":"åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ç»´æŠ¤äººå‘˜å¢å¤šæˆ–å˜æ›´ï¼Œä¼šå‡ºç°è´¨é‡çš„ä¸‹é™çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯æ¡†æ¶ä»£ç ï¼Œè¦æ—¶åˆ»ç‰¢è®°çš„ç»†èŠ‚ã€‚å¯èƒ½ä¸‹é¢è¦è®²çš„è¿™äº›ï¼Œå¤§å®¶éƒ½ä¼šè§‰å¾—å¾ˆç®€å•ï¼Œå¾ˆåŸºç¡€ï¼Œä½†è¦åšåˆ°æ—¶åˆ»ç‰¢è®°ã€‚åœ¨æ¯ä¸€è¡Œä»£ç ä¸­éƒ½è€ƒè™‘è¿™äº›å› ç´ ï¼Œæ˜¯éœ€è¦å¾ˆå¤§è€å¿ƒçš„ã€‚ é˜²æ­¢ç©ºæŒ‡é’ˆå’Œä¸‹æ ‡è¶Šç•Œè¿™æ˜¯æˆ‘æœ€ä¸å–œæ¬¢çœ‹åˆ°çš„å¼‚å¸¸ï¼Œå°¤å…¶åœ¨æ ¸å¿ƒæ¡†æ¶ä¸­ï¼Œæˆ‘æ›´æ„¿çœ‹åˆ°ä¿¡æ¯è¯¦ç»†çš„å‚æ•°ä¸åˆæ³•å¼‚å¸¸ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç¼–å†™å¥å£®ç¨‹åºçš„å¼€å‘äººå‘˜ï¼Œåœ¨å†™æ¯ä¸€è¡Œä»£ç éƒ½åº”åœ¨æ½œæ„è¯†ä¸­é˜²æ­¢çš„å¼‚å¸¸ã€‚åŸºæœ¬ä¸Šè¦èƒ½ç¡®ä¿æ¯ä¸€æ¬¡å†™å®Œçš„ä»£ç ï¼Œåœ¨ä¸æµ‹è¯•çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šå‡ºç°è¿™ä¸¤ä¸ªå¼‚å¸¸æ‰ç®—åˆæ ¼ã€‚ ä¿è¯çº¿ç¨‹å®‰å…¨æ€§å’Œå¯è§æ€§å¯¹äºæ¡†æ¶çš„å¼€å‘äººå‘˜ï¼Œå¯¹çº¿ç¨‹å®‰å…¨æ€§å’Œå¯è§æ€§çš„æ·±å…¥ç†è§£æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ã€‚éœ€è¦å¼€å‘äººå‘˜ï¼Œåœ¨å†™æ¯ä¸€è¡Œä»£ç æ—¶éƒ½åº”åœ¨æ½œæ„è¯†ä¸­ç¡®ä¿å…¶æ­£ç¡®æ€§ã€‚å› ä¸ºè¿™ç§ä»£ç ï¼Œåœ¨å°å¹¶å‘ä¸‹åšåŠŸèƒ½æµ‹è¯•æ—¶ï¼Œä¼šæ˜¾å¾—å¾ˆæ­£å¸¸ã€‚ä½†åœ¨é«˜å¹¶å‘ä¸‹å°±ä¼šå‡ºç°è«æ˜å…¶å¦™çš„é—®é¢˜ï¼Œè€Œä¸”åœºæ™¯å¾ˆéš¾é‡ç°ï¼Œæéš¾æ’æŸ¥ã€‚ å°½æ—©å¤±è´¥å’Œå‰ç½®æ–­è¨€å°½æ—©å¤±è´¥ä¹Ÿåº”è¯¥æˆä¸ºæ½œæ„è¯†ï¼Œåœ¨æœ‰ä¼ å…¥å‚æ•°å’ŒçŠ¶æ€å˜åŒ–æ—¶ï¼Œå‡åœ¨å…¥å£å¤„å…¨éƒ¨æ–­è¨€ã€‚ä¸€ä¸ªä¸åˆæ³•çš„å€¼å’ŒçŠ¶æ€ï¼Œåœ¨ç¬¬ä¸€æ—¶é—´å°±åº”æŠ¥é”™ï¼Œè€Œä¸æ˜¯ç­‰åˆ°è¦ç”¨æ—¶æ‰æŠ¥é”™ã€‚å› ä¸ºç­‰åˆ°è¦ç”¨æ—¶ï¼Œå¯èƒ½å‰é¢å·²ç»ä¿®æ”¹å…¶å®ƒç›¸å…³çŠ¶æ€ï¼Œè€Œåœ¨ç¨‹åºä¸­å¾ˆå°‘æœ‰äººå»å¤„ç†å›æ»šé€»è¾‘ã€‚è¿™æ ·æŠ¥é”™åï¼Œå…¶å®å†…éƒ¨çŠ¶æ€å¯èƒ½å·²ç»æ··ä¹±ï¼Œææ˜“åœ¨ä¸€ä¸ªéšè”½åˆ†æ”¯ä¸Šå¼•å‘ç¨‹åºä¸å¯æ¢å¤ã€‚ åˆ†ç¦»å¯é æ“ä½œå’Œä¸å¯é æ“ä½œè¿™é‡Œçš„å¯é æ˜¯ç‹­ä¹‰çš„æŒ‡æ˜¯å¦ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–å¼•èµ·çŠ¶æ€ä¸ä¸€è‡´ï¼Œæ¯”å¦‚ï¼Œå†™å…¥ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Mapï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¯é çš„ï¼Œè€Œå†™å…¥æ•°æ®åº“ç­‰ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸å¯é çš„ã€‚å¼€å‘äººå‘˜å¿…é¡»åœ¨å†™æ¯ä¸€è¡Œä»£ç æ—¶ï¼Œéƒ½æ³¨æ„å®ƒçš„å¯é æ€§ä¸å¦ï¼Œåœ¨ä»£ç ä¸­å°½é‡åˆ’åˆ†å¼€ï¼Œå¹¶å¯¹å¤±è´¥åšå¼‚å¸¸å¤„ç†ï¼Œå¹¶ä¸ºå®¹é”™ï¼Œè‡ªæˆ‘ä¿æŠ¤ï¼Œè‡ªåŠ¨æ¢å¤æˆ–åˆ‡æ¢ç­‰è¡¥å¿é€»è¾‘æä¾›æ¸…æ™°çš„åˆ‡å…¥ç‚¹ï¼Œä¿è¯åç»­å¢åŠ çš„ä»£ç ä¸è‡³äºæ”¾é”™ä½ç½®ï¼Œè€Œå¯¼è‡´åŸå…ˆçš„å®¹é”™å¤„ç†é™·å…¥æ··ä¹±ã€‚ å¼‚å¸¸é˜²å¾¡ï¼Œä½†ä¸å¿½ç•¥å¼‚å¸¸è¿™é‡Œè®²çš„å¼‚å¸¸é˜²å¾¡ï¼ŒæŒ‡çš„æ˜¯å¯¹éå¿…é¡»é€”å¾„ä¸Šçš„ä»£ç è¿›è¡Œæœ€å¤§é™åº¦çš„å®¹å¿ï¼ŒåŒ…æ‹¬ç¨‹åºä¸Šçš„ BUGï¼Œæ¯”å¦‚ï¼šè·å–ç¨‹åºçš„ç‰ˆæœ¬å·ï¼Œä¼šé€šè¿‡æ‰«æ Manifest å’Œ jar åŒ…åç§°æŠ“å–ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªé€»è¾‘æ˜¯è¾…åŠ©æ€§çš„ï¼Œä½†ä»£ç å´ä¸å°‘ï¼Œåˆæ­¥æµ‹è¯•ä¹Ÿæ²¡å•¥é—®é¢˜ï¼Œä½†åº”è¯¥åœ¨æ•´ä¸ª getVersion() ä¸­åŠ ä¸Šä¸€ä¸ªå…¨å‡½æ•°çš„ try-catch æ‰“å°é”™è¯¯æ—¥å¿—ï¼Œå¹¶è¿”å›åŸºæœ¬ç‰ˆæœ¬ï¼Œå› ä¸º getVersion() å¯èƒ½å­˜åœ¨æœªçŸ¥ç‰¹å®šåœºæ™¯å¼‚å¸¸ï¼Œæˆ–è¢«å…¶ä»–çš„å¼€å‘äººå‘˜è¯¯ä¿®æ”¹é€»è¾‘(ä½†ä¸€èˆ¬äººå‘˜ä¸ä¼šå»æ‰ try-catch)ï¼Œè€Œå¦‚æœå®ƒæŠ›å‡ºå¼‚å¸¸ä¼šå¯¼è‡´ä¸»æµç¨‹å¼‚å¸¸ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›çœ‹åˆ°çš„ã€‚ä½†è¿™é‡Œè¦æ§åˆ¶ä¸ªåº¦ï¼Œä¸è¦éšæ„ try-catchï¼Œæ›´ä¸è¦æ— å£°æ— æ¯çš„åƒæ‰å¼‚å¸¸ã€‚ ç¼©å°å¯å˜åŸŸå’Œå°½é‡ finalå¦‚æœä¸€ä¸ªç±»å¯ä»¥æˆä¸ºä¸å˜ç±»(Immutable Class)ï¼Œå°±ä¼˜å…ˆå°†å®ƒè®¾è®¡æˆä¸å˜ç±»ã€‚ä¸å˜ç±»æœ‰å¤©ç„¶çš„å¹¶å‘å…±äº«ä¼˜åŠ¿ï¼Œå‡å°‘åŒæ­¥æˆ–å¤åˆ¶ï¼Œè€Œä¸”å¯ä»¥æœ‰æ•ˆå¸®å¿™åˆ†æçº¿ç¨‹å®‰å…¨çš„èŒƒå›´ã€‚å°±ç®—æ˜¯å¯å˜ç±»ï¼Œå¯¹äºä»æ„é€ å‡½æ•°ä¼ å…¥çš„å¼•ç”¨ï¼Œåœ¨ç±»ä¸­æŒæœ‰æ—¶ï¼Œæœ€å¥½å°†å­—æ®µ finalï¼Œä»¥å…è¢«ä¸­é€”è¯¯ä¿®æ”¹å¼•ç”¨ã€‚ä¸è¦ä»¥ä¸ºè¿™ä¸ªå­—æ®µæ˜¯ç§æœ‰çš„ï¼Œè¿™ä¸ªç±»çš„ä»£ç éƒ½æ˜¯æˆ‘è‡ªå·±å†™çš„ï¼Œä¸ä¼šå‡ºç°å¯¹è¿™ä¸ªå­—æ®µçš„é‡æ–°èµ‹å€¼ã€‚è¦è€ƒè™‘çš„ä¸€ä¸ªå› ç´ æ˜¯ï¼Œè¿™ä¸ªä»£ç å¯èƒ½è¢«å…¶ä»–äººä¿®æ”¹ï¼Œä»–ä¸çŸ¥é“ä½ çš„è¿™ä¸ªå¼±çº¦å®šï¼Œfinal å°±æ˜¯ä¸€ä¸ªä¸å˜å¥‘çº¦ã€‚ é™ä½ä¿®æ”¹æ—¶çš„è¯¯è§£æ€§ï¼Œä¸åŸ‹é›·å‰é¢ä¸åœçš„æåˆ°ä»£ç è¢«å…¶ä»–äººä¿®æ”¹ï¼Œè¿™ä¹Ÿå¼€å‘äººå‘˜è¦éšæ—¶ç´§è®°çš„ã€‚è¿™ä¸ªå…¶ä»–äººåŒ…æ‹¬æœªæ¥çš„è‡ªå·±ï¼Œä½ è¦æ€»æƒ³ç€è¿™ä¸ªä»£ç å¯èƒ½ä¼šæœ‰äººå»æ”¹å®ƒã€‚æˆ‘åº”è¯¥ç»™ä¿®æ”¹çš„äººä¸€ç‚¹ä»€ä¹ˆæç¤ºï¼Œè®©ä»–çŸ¥é“æˆ‘ç°åœ¨çš„è®¾è®¡æ„å›¾ï¼Œè€Œä¸è¦åœ¨ç¨‹åºé‡Œé¢åŠ æ½œè§„åˆ™ï¼Œæˆ–åŸ‹ä¸€äº›å®¹æ˜“å¿½è§†çš„é›·ï¼Œæ¯”å¦‚ï¼šä½ ç”¨ null è¡¨ç¤ºä¸å¯ç”¨ï¼Œsize ç­‰äº 0 è¡¨ç¤ºé»‘åå•ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé›·ï¼Œä¸‹ä¸€ä¸ªä¿®æ”¹è€…ï¼ŒåŒ…æ‹¬ä½ è‡ªå·±ï¼Œéƒ½ä¸ä¼šè®°å¾—æœ‰è¿™æ ·çš„çº¦å®šï¼Œå¯èƒ½åé¢ä¸ºäº†æ”¹æŸä¸ªå…¶å®ƒ BUGï¼Œä¸å°å¿ƒæ”¹åˆ°äº†è¿™é‡Œï¼Œç›´æ¥å¼•çˆ†æ•…éšœã€‚å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œä¸€ä¸ªåŸåˆ™å°±æ˜¯æ°¸è¿œä¸è¦åŒºåˆ† null å¼•ç”¨å’Œ empty å€¼ã€‚ æé«˜ä»£ç çš„å¯æµ‹æ€§è¿™é‡Œçš„å¯æµ‹æ€§ä¸»è¦æŒ‡ Mock çš„å®¹æ˜“ç¨‹åº¦ï¼Œå’Œæµ‹è¯•çš„éš”ç¦»æ€§ã€‚è‡³äºæµ‹è¯•çš„è‡ªåŠ¨æ€§ï¼Œå¯é‡å¤æ€§ï¼Œéå¶ç„¶æ€§ï¼Œæ— åºæ€§ï¼Œå®Œå¤‡æ€§(å…¨è¦†ç›–)ï¼Œè½»é‡æ€§(å¯å¿«é€Ÿæ‰§è¡Œ)ï¼Œä¸€èˆ¬å¼€å‘äººå‘˜ï¼ŒåŠ ä¸Š JUnit ç­‰å·¥å…·çš„è¾…åŠ©åŸºæœ¬éƒ½èƒ½åšåˆ°ï¼Œä¹Ÿèƒ½ç†è§£å®ƒçš„å¥½å¤„ï¼Œåªæ˜¯å·¥ä½œé‡é—®é¢˜ã€‚è¿™é‡Œè¦ç‰¹åˆ«å¼ºè°ƒçš„æ˜¯æµ‹è¯•ç”¨ä¾‹çš„å•ä¸€æ€§(åªæµ‹ç›®æ ‡ç±»æœ¬èº«)å’Œéš”ç¦»æ€§(ä¸ä¼ æŸ“å¤±è´¥)ã€‚ç°åœ¨çš„æµ‹è¯•ä»£ç ï¼Œè¿‡äºå¼ºè°ƒå®Œå¤‡æ€§ï¼Œå¤§é‡é‡å¤äº¤å‰æµ‹è¯•ï¼Œçœ‹èµ·æ¥æ²¡å•¥åå¤„ï¼Œä½†æµ‹è¯•ä»£ç è¶Šå¤šï¼Œç»´æŠ¤ä»£ä»·è¶Šé«˜ã€‚ç»å¸¸å‡ºç°çš„é—®é¢˜æ˜¯ï¼Œä¿®æ”¹ä¸€è¡Œä»£ç æˆ–åŠ ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œå¼•èµ· 100 å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ä¸é€šè¿‡ã€‚æ—¶é—´ä¸€ç´§ï¼Œè°æœ‰è¿™ä¸ªé—²åŠŸå¤«å»æ”¹è¿™ä¹ˆå¤šå½¢æ€å„å¼‚çš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿä¹…è€Œä¹…ä¹‹ï¼Œè¿™ä¸ªæµ‹è¯•ä»£ç å°±å·²ç»ä¸èƒ½çœŸå®ååº”ä»£ç ç°åœ¨çš„çŠ¶å†µï¼Œå¾ˆå¤šæ—¶å€™ä¼šè¢«è¿«ç»•è¿‡ã€‚æœ€å¥½çš„æƒ…å†µæ˜¯ï¼Œä¿®æ”¹ä¸€è¡Œä»£ç ï¼Œæœ‰ä¸”åªæœ‰ä¸€è¡Œæµ‹è¯•ä»£ç ä¸é€šè¿‡ã€‚å¦‚æœä¿®æ”¹äº†ä»£ç è€Œæµ‹è¯•ç”¨ä¾‹è¿˜èƒ½é€šè¿‡ï¼Œé‚£ä¹Ÿä¸è¡Œï¼Œè¡¨ç¤ºæµ‹è¯•æ²¡æœ‰è¦†ç›–åˆ°ã€‚å¦å¤–ï¼Œå¯ Mock æ€§æ˜¯éš”ç¦»çš„åŸºç¡€ï¼ŒæŠŠé—´æ¥ä¾èµ–çš„é€»è¾‘å±è”½æ‰ã€‚å¯ Mock æ€§çš„ä¸€ä¸ªæœ€å¤§çš„æ€æ‰‹å°±æ˜¯é™æ€æ–¹æ³•ï¼Œå°½é‡å°‘ç”¨ã€‚","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"springboot","slug":"springboot","permalink":"https://github.com/weiecho/tags/springboot/"},{"name":"cloud","slug":"cloud","permalink":"https://github.com/weiecho/tags/cloud/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://github.com/weiecho/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"}]},{"title":"Apolloåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒå¿«é€Ÿå…¥é—¨","slug":"stu_1112","date":"2019-11-02T04:21:22.000Z","updated":"2020-07-03T02:32:12.986Z","comments":true,"path":"2019/11/02/stu_1112/","link":"","permalink":"https://github.com/weiecho/2019/11/02/stu_1112/","excerpt":"","text":"Apolloï¼ˆé˜¿æ³¢ç½—ï¼‰æ˜¯æºç¨‹æ¡†æ¶éƒ¨é—¨ç ”å‘çš„åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œèƒ½å¤Ÿé›†ä¸­åŒ–ç®¡ç†åº”ç”¨ä¸åŒç¯å¢ƒã€ä¸åŒé›†ç¾¤çš„é…ç½®ï¼Œé…ç½®ä¿®æ”¹åèƒ½å¤Ÿå®æ—¶æ¨é€åˆ°åº”ç”¨ç«¯ï¼Œå¹¶ä¸”å…·å¤‡è§„èŒƒçš„æƒé™ã€æµç¨‹æ²»ç†ç­‰ç‰¹æ€§ï¼Œé€‚ç”¨äºå¾®æœåŠ¡é…ç½®ç®¡ç†åœºæ™¯ã€‚ é¡¹ç›®åœ°å€ï¼šapolloåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ apollo 1ã€å…³é”®è¯AppIdï¼šå”¯ä¸€æŒ‡å®šé¡¹ç›®/é…ç½®çš„idï¼Œéœ€åœ¨é¡¹ç›®è®¾ç½®æŒ‡å®šapp.id ENVï¼šå½“å‰è·å–çš„é…ç½®ç¯å¢ƒï¼Œå¯¹åº”DEV/FAT/UAT/PROç­‰ Namespaceï¼šæ ¹æ®å‘½åç©ºé—´åˆ’åˆ†æ¯ä¸€ç±»é…ç½®çš„ Clusterï¼šå¤šé›†ç¾¤ç¯å¢ƒçŠ¶å†µä¸‹çš„é…ç½®å®ç°ï¼Œé»˜è®¤ä¸ºdefault å…³è”ï¼šå¯ä»¥å…³è”çš„Public Namespaceè¦†ç›–ç‰¹æ®Šå±æ€§ 2ã€æ“ä½œç‚¹å‘å¸ƒï¼šå°†è°ƒæ•´åæœªå‘å¸ƒçš„é…ç½®éƒ¨ç½²è‡³åº”ç”¨å¯ç”¨çŠ¶æ€ å›æ»šï¼šå›æ»šè‡³ç¡®å®æœ‰ä¿®æ”¹çš„ä¸Šä¸€å‘å¸ƒç‰ˆæœ¬ ç°åº¦ï¼šå¯æ ¹æ®æœåŠ¡èŠ‚ç‚¹IPæˆ–AppId(public) éƒ¨åˆ†ç”Ÿæ•ˆé…ç½®ï¼Œå¯ä»¥å…¨é‡å‘å¸ƒ åˆ›å»ºClusterï¼šåˆ›å»ºä¸åŒçš„é…ç½®é›†ç¾¤ åˆ›å»º/å…³è”Namespaceï¼šåˆ›å»ºæˆ–å…³è”Namespace 3ã€æ ¸å¿ƒç‚¹é¡¹ç›®AppIdï¼šè¯·ä¸ºæ¯ä¸€ä¸ªæœåŠ¡åˆ›å»ºå¹¶é…ç½®ç‹¬ç«‹çš„appId å®¿ä¸»æœºENVï¼šå½“å‰åº”ç”¨æ‰€åœ¨çš„ç¯å¢ƒï¼Œè¯·è®¾ç½® /opt/settings/server.properties apollo.metaï¼šå½“å‰åº”ç”¨ç¯å¢ƒè¿æ¥çš„æ³¨å†Œä¸­å¿ƒåœ°å€ï¼Œè¯·è®¾ç½®/opt/settings/server.properties Privateï¼šå½“å‰AppIdç§æœ‰çš„å‘½åç©ºé—´é…ç½®å±æ€§ Publicï¼šæ‰€æœ‰é¡¹ç›®å¯ä»¥å…¬ç”¨çš„å‘½åç©ºé—´é…ç½®å±æ€§ å¤šNamespaceï¼šé¡¹ç›®ä¸­å¯é…ç½®å¤šä¸ªå‘½åç©ºé—´ï¼Œnamespaces: bootstrap,application,dubbo Publicå…³è”/è¦†ç›–ï¼šå¦‚éœ€ä¿®æ”¹Publicé…ç½®ï¼Œè¯·å…³è”Namepaceåˆ°å½“å‰é¡¹ç›®é…ç½®åè¦†ç›–å±æ€§","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"é…ç½®ä¸­å¿ƒ","slug":"é…ç½®ä¸­å¿ƒ","permalink":"https://github.com/weiecho/tags/%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/"},{"name":"apollo","slug":"apollo","permalink":"https://github.com/weiecho/tags/apollo/"}]},{"title":"JVMæ€§èƒ½ä¼˜åŒ–å»ºè®®","slug":"exp_1113","date":"2019-10-20T14:30:31.000Z","updated":"2020-07-03T02:03:50.817Z","comments":true,"path":"2019/10/20/exp_1113/","link":"","permalink":"https://github.com/weiecho/2019/10/20/exp_1113/","excerpt":"","text":"123456ä¼˜åŒ–å»ºè®®ï¼š1ã€ä¸€èˆ¬å»ºè®®Xmsç­‰äºXmxï¼Œå¥½å¤„æ˜¯é¿å…æ¯æ¬¡gcåï¼Œè°ƒæ•´å †çš„å¤§å°ï¼Œå‡å°‘ç³»ç»Ÿå†…å­˜åˆ†é…å¼€é”€2ã€ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨(Serial + Serial Old | -XX:+UseSerialGC)3ã€å¹¶è¡Œåƒåœ¾æ”¶é›†å™¨(Parellel + Parellel Old)ï¼Œååé‡ä¼˜å…ˆï¼ˆJVM server æ¨¡å¼ é»˜è®¤ï¼‰4ã€å¹¶å‘åƒåœ¾æ”¶é›†å™¨ï¼ˆParNew + CMSï¼‰å“åº”æ—¶é—´ä¼˜å…ˆ5ã€æœ¬æ¬¡ä¼˜åŒ–è¯´æ˜çš„JDKç‰ˆæœ¬ä¸º1.8 é€šç”¨é…ç½®1ã€java -Xmx2g -Xms2g -XX:MetaspaceSize=256m -XX:+UseConcMarkSweepGC å¹¶å‘å¤§ï¼Œå¯¹è±¡å°2ã€java -Xmx2g -Xms2g -Xmn512m -XX:MetaspaceSize=256m -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=2 -XX:+UseCMSCompactAtFullCollection å¹¶å‘å¤§ï¼Œå¯¹è±¡å¤§3ã€java -Xmx4g -Xms4g -Xmn2g -XX:MetaspaceSize=512m -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=2 -XX:+UseCMSCompactAtFullCollection æ ¸å¿ƒå‚æ•° è¯´æ˜ é»˜è®¤å€¼ å¤‡æ³¨ -Xms æœ€å°å †å†…å­˜ é»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/64ï¼Œä¸ä¼šè¶…è¿‡1G -Xmx æœ€å¤§å †å†…å­˜ é»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/4 -Xmn æ–°ç”Ÿä»£å†…å­˜å¤§å° é»˜è®¤å€¼ä¸º-Xmxçš„3/8ï¼Œè€å¹´ä»£å†…å­˜åˆ™ä¸º5/8 ä¼˜å…ˆçº§è¾ƒNewRatioé«˜ -XX:NewRatio æ–°ç”Ÿä»£ä¸è€ç”Ÿä»£çš„å†…å­˜çš„æ¯”å€¼ 2 -XX:SurvivorRatio Edenå’Œ2ä¸ªå­˜æ´»åŒºå†…å­˜çš„æ¯”å€¼ 8 -XX:MetaspaceSize å…ƒç©ºé—´æœ€å°å€¼ å…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ -XX:MaxMetaspaceSize å…ƒç©ºé—´æœ€å¤§å€¼ -Xss æ ˆå¤§å° 1M -XX:ParallelGCThreads å¹¶è¡Œæ”¶é›†å™¨çš„çº¿ç¨‹æ•° é»˜è®¤ä¸ºæœåŠ¡å™¨CPUæ•°ç›® æ­¤å€¼æœ€å¥½é…ç½®ä¸å¤„ç†å™¨æ•°ç›®ç›¸ç­‰ åŒæ ·é€‚ç”¨äºCMSä¸ç”¨è®¾ç½® -XX:PretenureSizeThreshold æ‰‹åŠ¨æŒ‡å®šå¯¹è±¡å¤§å° å½“å¯¹è±¡è¾¾åˆ°æŒ‡å®šå¤§å°æ—¶ç›´æ¥å­˜æ”¾åˆ°è€å¹´ä»£ä¸­ï¼Œç”±äºæ–°ç”Ÿä»£å¤§å¤šä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä¸ºäº†èŠ‚çœå¤åˆ¶æ¶ˆè€— -XX:MaxTenuringThreshold æ‰‹åŠ¨è®¾ç½®å¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­å­˜æ´»å¹´é¾„(å­˜æ´»æ¬¡æ•°) 15 -XX:+UseConcMarkSweepGC æ‰‹åŠ¨æŒ‡å®šè€å¹´ä»£ä½¿ç”¨CMSæ”¶é›†å™¨ -XX:-CMSParallelRemarkEnabled æ‰‹åŠ¨é…ç½®å¼€å¯å¹¶è¡Œæ ‡è®°ï¼ŒèŠ‚çœå¹´è½»ä»£æ ‡è®°æ—¶é—´ åºŸå¼ƒ -XX:CMSInitiatingOccupancyFraction=80 æ‰‹åŠ¨æŒ‡å®šå½“è€å¹´ä»£å·²ç”¨ç©ºé—´è¾¾åˆ°80%æ—¶ï¼Œè§¦å‘è€å¹´ä»£å›æ”¶(é»˜è®¤92%) -1 -XX:+UseCMSCompactAtFullCollection åœ¨è¿›è¡ŒFull GCæ—¶å¯¹å†…å­˜è¿›è¡Œå‹ç¼© JDK1.6ä»¥å‰ä¸éœ€è¦é…ç½®ï¼Œé»˜è®¤å¼€å¯ -XX:CMSFullGCsBeforeCompaction=2 ä¸XX:+UseCMSCompactAtFullCollectionå…³è”ä½¿ç”¨æ ‡è¯†ç€æ¯ç»è¿‡å¤šå°‘æ¬¡Full GC 0 è§¦å‘å¯¹å†…å­˜è¿›è¡Œä¸€æ¬¡å‹ç¼©ï¼Œé»˜è®¤æ˜¯0æ¬¡","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"spring","slug":"spring","permalink":"https://github.com/weiecho/tags/spring/"},{"name":"æ¶æ„è®¾è®¡","slug":"æ¶æ„è®¾è®¡","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"},{"name":"JVM","slug":"JVM","permalink":"https://github.com/weiecho/tags/JVM/"}]},{"title":"è®¾è®¡å®ç°çš„å¥å£®æ€§","slug":"exp_1114","date":"2019-10-07T14:30:31.000Z","updated":"2020-07-03T02:03:46.069Z","comments":true,"path":"2019/10/07/exp_1114/","link":"","permalink":"https://github.com/weiecho/2019/10/07/exp_1114/","excerpt":"","text":"æ—¥å¿—æ—¥å¿—æ˜¯å‘ç°é—®é¢˜ã€æŸ¥çœ‹é—®é¢˜ä¸€ä¸ªæœ€å¸¸ç”¨çš„æ‰‹æ®µã€‚æ—¥å¿—è´¨é‡å¾€å¾€è¢«å¿½è§†ï¼Œæ²¡æœ‰æ—¥å¿—ä½¿ç”¨ä¸Šçš„æ˜ç¡®çº¦å®šã€‚é‡è§† Log çš„ä½¿ç”¨ï¼Œæé«˜ Log çš„ä¿¡æ¯æµ“åº¦ã€‚æ—¥å¿—è¿‡å¤šã€è¿‡äºæ··ä¹±ï¼Œä¼šå¯¼è‡´æœ‰ç”¨çš„ä¿¡æ¯è¢«æ·¹æ²¡ã€‚ è¦æœ‰æ•ˆåˆ©ç”¨è¿™ä¸ªå·¥å…·è¦æ³¨æ„ï¼š ä¸¥æ ¼çº¦å®šWARNã€ERRORçº§åˆ«è®°å½•çš„å†…å®¹WARN è¡¨ç¤ºå¯ä»¥æ¢å¤çš„é—®é¢˜ï¼Œæ— éœ€äººå·¥ä»‹å…¥ã€‚ERROR è¡¨ç¤ºéœ€è¦äººå·¥ä»‹å…¥é—®é¢˜ã€‚æœ‰äº†è¿™æ ·çš„çº¦å®šï¼Œç›‘ç®¡ç³»ç»Ÿå‘ç°æ—¥å¿—æ–‡ä»¶çš„ä¸­å‡ºç° ERROR å­—ä¸²å°±æŠ¥è­¦ï¼Œåˆå°½é‡å‡å°‘äº†å‘ç”Ÿã€‚è¿‡å¤šçš„æŠ¥è­¦ä¼šè®©äººç–²å€¦ï¼Œä½¿äººå¯¹æŠ¥è­¦å¤±å»è­¦æƒ•æ€§ï¼Œä½¿ ERROR æ—¥å¿—å¤±å»æ„ä¹‰ã€‚å†è¾…ä»¥äººå·¥å®šæœŸæŸ¥çœ‹ WARN çº§åˆ«ä¿¡æ¯ï¼Œä»¥è¯„ä¼°ç³»ç»Ÿçš„â€œäºšå¥åº·â€ç¨‹åº¦ã€‚ æ—¥å¿—ä¸­ï¼Œå°½é‡å¤šçš„æ”¶é›†å…³é”®ä¿¡æ¯å‡ºé—®é¢˜æ—¶çš„ç°åœºä¿¡æ¯ï¼Œå³æ’æŸ¥é—®é¢˜è¦ç”¨åˆ°çš„ä¿¡æ¯ã€‚å¦‚æœåŠ¡è°ƒç”¨å¤±è´¥æ—¶ï¼Œè¦ç»™å‡ºä½¿ç”¨ Dubbo çš„ç‰ˆæœ¬ã€æœåŠ¡æä¾›è€…çš„ IPã€ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ³¨å†Œä¸­å¿ƒï¼›è°ƒç”¨çš„æ˜¯å“ªä¸ªæœåŠ¡ã€å“ªä¸ªæ–¹æ³•ç­‰ç­‰ã€‚è¿™äº›ä¿¡æ¯å¦‚æœä¸ç»™å‡ºï¼Œé‚£ä¹ˆäº‹åäººå·¥æ”¶é›†çš„ï¼Œé—®é¢˜è¿‡åç°åœºå¯èƒ½å·²ç»ä¸èƒ½å¤åŸï¼ŒåŠ å¤§æ’æŸ¥é—®é¢˜çš„éš¾åº¦ã€‚å¦‚æœå¯èƒ½ï¼Œç»™å‡ºé—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ³•ã€‚è¿™è®©ç»´æŠ¤å’Œé—®é¢˜è§£å†³å˜å¾—ç®€å•ï¼Œè€Œä¸æ˜¯å¯»æ±‚ç²¾é€šè€…ï¼ˆå¾€å¾€æ˜¯å®ç°è€…ï¼‰çš„å¸®åŠ©ã€‚ åŒä¸€ä¸ªæˆ–æ˜¯ä¸€ç±»é—®é¢˜ä¸è¦é‡å¤è®°å½•å¤šæ¬¡åŒä¸€ä¸ªæˆ–æ˜¯ä¸€ç±»å¼‚å¸¸æ—¥å¿—è¿ç»­å‡ºç°å‡ åéçš„æƒ…å†µï¼Œè¿˜æ˜¯å¸¸å¸¸èƒ½çœ‹åˆ°çš„ã€‚äººçœ¼å¾ˆå®¹æ˜“æ¼æ‰æ·¹æ²¡åœ¨å…¶ä¸­ä¸ä¸€æ ·çš„é‡è¦æ—¥å¿—ä¿¡æ¯ã€‚è¦å°½é‡é¿å…è¿™ç§æƒ…å†µã€‚åœ¨å¯ä»¥é¢„è§ä¼šå‡ºç°çš„æƒ…å†µï¼Œæœ‰å¿…è¦åŠ ä¸€äº›é€»è¾‘æ¥é¿å…ã€‚ å¦‚ä¸ºä¸€ä¸ªé—®é¢˜å‡†å¤‡ä¸€ä¸ªæ ‡å¿—ï¼Œå‡ºé—®é¢˜åæ‰“æ—¥å¿—åè®¾ç½®æ ‡å¿—ï¼Œé¿å…é‡å¤æ‰“æ—¥å¿—ã€‚é—®é¢˜æ¢å¤åæ¸…é™¤æ ‡å¿—ã€‚ è™½ç„¶æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯è¿™æ ·åšä¿è¯æ—¥å¿—ä¿¡æ¯æµ“åº¦ï¼Œè®©ç›‘æ§æ›´æœ‰æ•ˆã€‚ ç•Œé™è®¾ç½®èµ„æºæ˜¯æœ‰é™çš„ï¼ŒCPUã€å†…å­˜ã€IO ç­‰ç­‰ã€‚ä¸è¦å› ä¸ºå¤–éƒ¨çš„è¯·æ±‚ã€æ•°æ®ä¸å—é™çš„è€Œå´©æºƒã€‚ çº¿ç¨‹æ± (ExectorService)çš„å¤§å°å’Œé¥±å’Œç­–ç•¥Server ç«¯ç”¨äºå¤„ç†è¯·æ±‚çš„ ExectorService è®¾ç½®ä¸Šé™ã€‚ExecutorService çš„ä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—ä½¿ç”¨æœ‰é™é˜Ÿåˆ—ï¼Œé¿å…èµ„æºè€—å°½ã€‚å½“ä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—é¥±å’Œæ—¶ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„é¥±å’Œç­–ç•¥ã€‚è¿™æ ·ä¿è¯å¹³æ»‘åŠ£åŒ–ã€‚ åœ¨ä¸€äº›è®¾è®¡ä¸­ï¼Œé¥±å’Œç­–ç•¥æ˜¯ä¸¢å¼ƒæ•°æ®ï¼Œç­‰å¾…ç»“æœä¹Ÿåªæ˜¯è¯·æ±‚çš„è¶…æ—¶ã€‚ è¾¾åˆ°é¥±å’Œæ—¶ï¼Œè¯´æ˜å·²ç»è¾¾åˆ°æœåŠ¡æä¾›æ–¹çš„è´Ÿè·ä¸Šé™ï¼Œè¦åœ¨é¥±å’Œç­–ç•¥çš„æ“ä½œä¸­æ—¥å¿—è®°å½•è¿™ä¸ªé—®é¢˜ï¼Œä»¥å‘å‡ºç›‘æ§è­¦æŠ¥ã€‚è®°å¾—æ³¨æ„ä¸è¦é‡å¤å¤šæ¬¡è®°å½•å“¦ã€‚ï¼ˆæ³¨æ„ï¼Œç¼ºçœçš„é¥±å’Œç­–ç•¥ä¸ä¼šæœ‰è¿™äº›é™„åŠ çš„æ“ä½œã€‚ï¼‰æ ¹æ®è­¦æŠ¥çš„é¢‘ç‡ï¼Œå·²ç»å†³å®šæ‰©å®¹è°ƒæ•´ç­‰ç­‰ï¼Œé¿å…ç³»ç»Ÿé—®é¢˜è¢«å¿½ç•¥ã€‚ é›†åˆå®¹é‡å¦‚æœç¡®ä¿è¿›å…¥é›†åˆçš„å…ƒç´ æ˜¯å¯æ§çš„ä¸”æ˜¯è¶³å¤Ÿå°‘ï¼Œåˆ™å¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚è¿™æ˜¯å¤§éƒ¨åˆ†çš„æƒ…å†µã€‚å¦‚æœä¸èƒ½ä¿è¯ï¼Œåˆ™ä½¿ç”¨æœ‰æœ‰ç•Œçš„é›†åˆã€‚å½“åˆ°è¾¾ç•Œé™æ—¶ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä¸¢å¼ƒç­–ç•¥ã€‚ å®¹é”™-é‡è¯•-æ¢å¤é«˜å¯ç”¨ç»„ä»¶è¦å®¹å¿å…¶ä¾èµ–ç»„ä»¶çš„å¤±è´¥ã€‚ æœåŠ¡æ³¨å†Œä¸­å¿ƒç›®å‰æœåŠ¡æ³¨å†Œä¸­å¿ƒä½¿ç”¨äº†æ•°æ®åº“æ¥ä¿å­˜æœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…çš„ä¿¡æ¯ã€‚æ³¨å†Œä¸­å¿ƒé›†ç¾¤ä¸åŒæ³¨å†Œä¸­å¿ƒä¹Ÿé€šè¿‡æ•°æ®åº“æ¥è¿›è¡ŒåŒæ­¥æ•°æ®ï¼Œä»¥æ„ŸçŸ¥å…¶å®ƒæ³¨å†Œä¸­å¿ƒä¸Šæä¾›è€…çš„å˜åŒ–ã€‚æ³¨å†Œä¸­å¿ƒä¼šåœ¨å†…å­˜ä¸­ä¿å­˜ä¸€ä»½æä¾›è€…å’Œæ¶ˆè´¹è€…æ•°æ®ï¼Œæ•°æ®åº“ä¸å¯ç”¨æ—¶ï¼Œæ³¨å†Œä¸­å¿ƒç‹¬ç«‹å¯¹å¤–æä¾›æœåŠ¡ä»¥ä¿è¯æ­£å¸¸è¿è½¬ï¼Œåªæ˜¯æ‹¿ä¸åˆ°å…¶å®ƒæ³¨å†Œä¸­å¿ƒçš„æ•°æ®ã€‚å½“æ•°æ®åº“æ¢å¤æ—¶ï¼Œé‡è¯•é€»è¾‘ä¼šå°†å†…å­˜ä¸­ä¿®æ”¹çš„æ•°æ®å†™å›æ•°æ®åº“ï¼Œå¹¶æ‹¿åˆ°æ•°æ®åº“ä¸­æ–°æ•°æ®ã€‚ æœåŠ¡çš„æ¶ˆè´¹è€…æœåŠ¡æ¶ˆè´¹è€…ä»æ³¨å†Œä¸­å¿ƒæ‹¿åˆ°æä¾›è€…åˆ—è¡¨åï¼Œä¼šä¿å­˜æä¾›è€…åˆ—è¡¨åˆ°å†…å­˜å’Œç£ç›˜æ–‡ä»¶ä¸­ã€‚è¿™æ ·æ³¨å†Œä¸­å¿ƒå®•æœºåæ¶ˆè´¹è€…å¯ä»¥æ­£å¸¸è¿è½¬ï¼Œç”šè‡³å¯ä»¥åœ¨æ³¨å†Œä¸­å¿ƒå®•æœºè¿‡ç¨‹ä¸­é‡å¯æ¶ˆè´¹è€…ã€‚æ¶ˆè´¹è€…å¯åŠ¨æ—¶ï¼Œå‘ç°æ³¨å†Œä¸­å¿ƒä¸å¯ç”¨ï¼Œä¼šè¯»å–ä¿å­˜åœ¨ç£ç›˜æ–‡ä»¶ä¸­æä¾›è€…åˆ—è¡¨ã€‚é‡è¯•é€»è¾‘ä¿è¯æ³¨å†Œä¸­å¿ƒæ¢å¤åï¼Œæ›´æ–°ä¿¡æ¯ã€‚ é‡è¯•å»¶è¿Ÿç­–ç•¥æ•°æ®åº“ä¸Šçš„æ´»é”æ³¨å†Œä¸­å¿ƒä¼šå®šæ—¶æ›´æ–°æ•°æ®åº“ä¸€æ¡è®°å½•çš„æ—¶é—´æˆ³ï¼Œè¿™æ ·é›†ç¾¤ä¸­å…¶å®ƒçš„æ³¨å†Œä¸­å¿ƒæ„ŸçŸ¥å®ƒæ˜¯å­˜æ´»ã€‚è¿‡æœŸæ³¨å†Œä¸­å¿ƒå’Œå®ƒçš„ç›¸å…³æ•°æ® ä¼šè¢«æ¸…é™¤ã€‚æ•°æ®åº“æ­£å¸¸æ—¶ï¼Œè¿™ä¸ªæœºåˆ¶è¿è¡Œè‰¯å¥½ã€‚ä½†æ˜¯æ•°æ®åº“è´Ÿè·é«˜æ—¶ï¼Œå…¶ä¸Šçš„æ¯ä¸ªæ“ä½œéƒ½ä¼šå¾ˆæ…¢ã€‚è¿™å°±å‡ºç°ï¼š A æ³¨å†Œä¸­å¿ƒè®¤ä¸º B è¿‡æœŸï¼Œåˆ é™¤ B çš„æ•°æ®ã€‚ B å‘ç°è‡ªå·±çš„æ•°æ®æ²¡æœ‰äº†ï¼Œé‡æ–°å†™å…¥è‡ªå·±çš„æ•°æ®çš„åå¤æ“ä½œã€‚è¿™äº›åå¤çš„æ“ä½œåˆåŠ é‡äº†æ•°æ®åº“çš„è´Ÿè·ï¼Œæ¶åŒ–é—®é¢˜ã€‚ å¯ä»¥ä½¿ç”¨ä¸‹é¢é€»è¾‘ï¼šå½“ B å‘ç°è‡ªå·±æ•°æ®è¢«åˆ é™¤æ—¶ï¼ˆå†™å…¥å¤±è´¥ï¼‰ï¼Œé€‰æ‹©ç­‰å¾…è¿™æ®µæ—¶é—´å†é‡è¯•ã€‚é‡è¯•æ—¶é—´å¯ä»¥é€‰æ‹©æŒ‡æ•°çº§å¢é•¿ï¼Œå¦‚ç¬¬ä¸€æ¬¡ç­‰ 1 åˆ†é’Ÿï¼Œç¬¬äºŒæ¬¡ 10 åˆ†é’Ÿã€ç¬¬ä¸‰æ¬¡ 100 åˆ†é’Ÿã€‚ è¿™æ ·æ“ä½œå‡å°‘åï¼Œä¿è¯æ•°æ®åº“å¯ä»¥å†·å´ï¼ˆCool Downï¼‰ä¸‹æ¥ã€‚ Client é‡è¿æ³¨å†Œä¸­å¿ƒå½“ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒåœæœºæ—¶ï¼Œå…¶å®ƒçš„ Client ä¼šåŒæ—¶æ¥æ”¶äº‹ä»¶ï¼Œè€Œå»é‡è¿å¦ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚Client æ•°é‡ç›¸å¯¹æ¯”è¾ƒå¤šï¼Œä¼šå¯¹æ³¨å†Œä¸­å¿ƒé€ æˆå†²å‡»ã€‚é¿å…æ–¹æ³•å¯ä»¥æ˜¯ Client é‡è¿æ—¶éšæœºå»¶æ—¶ 3 åˆ†é’Ÿï¼ŒæŠŠé‡è¿åˆ†æ•£å¼€ã€‚","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://github.com/weiecho/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"spring","slug":"spring","permalink":"https://github.com/weiecho/tags/spring/"},{"name":"æ¶æ„è®¾è®¡","slug":"æ¶æ„è®¾è®¡","permalink":"https://github.com/weiecho/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"}]},{"title":"XXL-JOBåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°","slug":"tool_1112","date":"2019-10-03T05:23:12.000Z","updated":"2020-07-03T02:04:29.411Z","comments":true,"path":"2019/10/03/tool_1112/","link":"","permalink":"https://github.com/weiecho/2019/10/03/tool_1112/","excerpt":"","text":"XXL-JOBæ˜¯ä¸€ä¸ªè½»é‡çº§åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç°å·²å¼€æ”¾æºä»£ç å¹¶æ¥å…¥å¤šå®¶å…¬å¸çº¿ä¸Šäº§å“çº¿ï¼Œå¼€ç®±å³ç”¨ã€‚ é¡¹ç›®åœ°å€ï¼šxxl-jobåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° ç®€å•ï¼šæ”¯æŒé€šè¿‡Webé¡µé¢å¯¹ä»»åŠ¡è¿›è¡ŒCRUDæ“ä½œï¼Œæ“ä½œç®€å•ï¼Œä¸€åˆ†é’Ÿä¸Šæ‰‹ï¼› åŠ¨æ€ï¼šæ”¯æŒåŠ¨æ€ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€å¯åŠ¨/åœæ­¢ä»»åŠ¡ï¼Œä»¥åŠç»ˆæ­¢è¿è¡Œä¸­ä»»åŠ¡ï¼Œå³æ—¶ç”Ÿæ•ˆï¼› è°ƒåº¦ä¸­å¿ƒHAï¼ˆä¸­å¿ƒå¼ï¼‰ï¼šè°ƒåº¦é‡‡ç”¨ä¸­å¿ƒå¼è®¾è®¡ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€è‡ªç ”è°ƒåº¦ç»„ä»¶å¹¶æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯è°ƒåº¦ä¸­å¿ƒHAï¼› æ‰§è¡Œå™¨HAï¼ˆåˆ†å¸ƒå¼ï¼‰ï¼šä»»åŠ¡åˆ†å¸ƒå¼æ‰§è¡Œï¼Œä»»åŠ¡â€æ‰§è¡Œå™¨â€æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯ä»»åŠ¡æ‰§è¡ŒHAï¼› æ³¨å†Œä¸­å¿ƒ: æ‰§è¡Œå™¨ä¼šå‘¨æœŸæ€§è‡ªåŠ¨æ³¨å†Œä»»åŠ¡, è°ƒåº¦ä¸­å¿ƒå°†ä¼šè‡ªåŠ¨å‘ç°æ³¨å†Œçš„ä»»åŠ¡å¹¶è§¦å‘æ‰§è¡Œã€‚åŒæ—¶ï¼Œä¹Ÿæ”¯æŒæ‰‹åŠ¨å½•å…¥æ‰§è¡Œå™¨åœ°å€ï¼› å¼¹æ€§æ‰©å®¹ç¼©å®¹ï¼šä¸€æ—¦æœ‰æ–°æ‰§è¡Œå™¨æœºå™¨ä¸Šçº¿æˆ–è€…ä¸‹çº¿ï¼Œä¸‹æ¬¡è°ƒåº¦æ—¶å°†ä¼šé‡æ–°åˆ†é…ä»»åŠ¡ï¼› è·¯ç”±ç­–ç•¥ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶æä¾›ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€è½®è¯¢ã€éšæœºã€ä¸€è‡´æ€§HASHã€æœ€ä¸ç»å¸¸ä½¿ç”¨ã€æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ã€æ•…éšœè½¬ç§»ã€å¿™ç¢Œè½¬ç§»ç­‰ï¼› æ•…éšœè½¬ç§»ï¼šä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹©â€æ•…éšœè½¬ç§»â€æƒ…å†µä¸‹ï¼Œå¦‚æœæ‰§è¡Œå™¨é›†ç¾¤ä¸­æŸä¸€å°æœºå™¨æ•…éšœï¼Œå°†ä¼šè‡ªåŠ¨Failoveråˆ‡æ¢åˆ°ä¸€å°æ­£å¸¸çš„æ‰§è¡Œå™¨å‘é€è°ƒåº¦è¯·æ±‚ã€‚ é˜»å¡å¤„ç†ç­–ç•¥ï¼šè°ƒåº¦è¿‡äºå¯†é›†æ‰§è¡Œå™¨æ¥ä¸åŠå¤„ç†æ—¶çš„å¤„ç†ç­–ç•¥ï¼Œç­–ç•¥åŒ…æ‹¬ï¼šå•æœºä¸²è¡Œï¼ˆé»˜è®¤ï¼‰ã€ä¸¢å¼ƒåç»­è°ƒåº¦ã€è¦†ç›–ä¹‹å‰è°ƒåº¦ï¼› ä»»åŠ¡è¶…æ—¶æ§åˆ¶ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼Œä»»åŠ¡è¿è¡Œè¶…æ—¶å°†ä¼šä¸»åŠ¨ä¸­æ–­ä»»åŠ¡ï¼› ä»»åŠ¡å¤±è´¥é‡è¯•ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡å¤±è´¥é‡è¯•æ¬¡æ•°ï¼Œå½“ä»»åŠ¡å¤±è´¥æ—¶å°†ä¼šæŒ‰ç…§é¢„è®¾çš„å¤±è´¥é‡è¯•æ¬¡æ•°ä¸»åŠ¨è¿›è¡Œé‡è¯•ï¼›å…¶ä¸­åˆ†ç‰‡ä»»åŠ¡æ”¯æŒåˆ†ç‰‡ç²’åº¦çš„å¤±è´¥é‡è¯•ï¼› ä»»åŠ¡å¤±è´¥å‘Šè­¦ï¼›é»˜è®¤æä¾›é‚®ä»¶æ–¹å¼å¤±è´¥å‘Šè­¦ï¼ŒåŒæ—¶é¢„ç•™æ‰©å±•æ¥å£ï¼Œå¯æ–¹ä¾¿çš„æ‰©å±•çŸ­ä¿¡ã€é’‰é’‰ç­‰å‘Šè­¦æ–¹å¼ï¼› åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶ï¼Œä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹©â€åˆ†ç‰‡å¹¿æ’­â€æƒ…å†µä¸‹ï¼Œä¸€æ¬¡ä»»åŠ¡è°ƒåº¦å°†ä¼šå¹¿æ’­è§¦å‘é›†ç¾¤ä¸­æ‰€æœ‰æ‰§è¡Œå™¨æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œå¯æ ¹æ®åˆ†ç‰‡å‚æ•°å¼€å‘åˆ†ç‰‡ä»»åŠ¡ï¼› åŠ¨æ€åˆ†ç‰‡ï¼šåˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ä»¥æ‰§è¡Œå™¨ä¸ºç»´åº¦è¿›è¡Œåˆ†ç‰‡ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹æ‰§è¡Œå™¨é›†ç¾¤ä»è€ŒåŠ¨æ€å¢åŠ åˆ†ç‰‡æ•°é‡ï¼ŒååŒè¿›è¡Œä¸šåŠ¡å¤„ç†ï¼›åœ¨è¿›è¡Œå¤§æ•°æ®é‡ä¸šåŠ¡æ“ä½œæ—¶å¯æ˜¾è‘—æå‡ä»»åŠ¡å¤„ç†èƒ½åŠ›å’Œé€Ÿåº¦ã€‚ äº‹ä»¶è§¦å‘ï¼šé™¤äº†â€Cronæ–¹å¼â€å’Œâ€ä»»åŠ¡ä¾èµ–æ–¹å¼â€è§¦å‘ä»»åŠ¡æ‰§è¡Œä¹‹å¤–ï¼Œæ”¯æŒåŸºäºäº‹ä»¶çš„è§¦å‘ä»»åŠ¡æ–¹å¼ã€‚è°ƒåº¦ä¸­å¿ƒæä¾›è§¦å‘ä»»åŠ¡å•æ¬¡æ‰§è¡Œçš„APIæœåŠ¡ï¼Œå¯æ ¹æ®ä¸šåŠ¡äº‹ä»¶çµæ´»è§¦å‘ã€‚ ä»»åŠ¡è¿›åº¦ç›‘æ§ï¼šæ”¯æŒå®æ—¶ç›‘æ§ä»»åŠ¡è¿›åº¦ï¼› Rollingå®æ—¶æ—¥å¿—ï¼šæ”¯æŒåœ¨çº¿æŸ¥çœ‹è°ƒåº¦ç»“æœï¼Œå¹¶ä¸”æ”¯æŒä»¥Rollingæ–¹å¼å®æ—¶æŸ¥çœ‹æ‰§è¡Œå™¨è¾“å‡ºçš„å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—ï¼› GLUEï¼šæä¾›Web IDEï¼Œæ”¯æŒåœ¨çº¿å¼€å‘ä»»åŠ¡é€»è¾‘ä»£ç ï¼ŒåŠ¨æ€å‘å¸ƒï¼Œå®æ—¶ç¼–è¯‘ç”Ÿæ•ˆï¼Œçœç•¥éƒ¨ç½²ä¸Šçº¿çš„è¿‡ç¨‹ã€‚æ”¯æŒ30ä¸ªç‰ˆæœ¬çš„å†å²ç‰ˆæœ¬å›æº¯ã€‚ è„šæœ¬ä»»åŠ¡ï¼šæ”¯æŒä»¥GLUEæ¨¡å¼å¼€å‘å’Œè¿è¡Œè„šæœ¬ä»»åŠ¡ï¼ŒåŒ…æ‹¬Shellã€Pythonã€NodeJSã€PHPã€PowerShellç­‰ç±»å‹è„šæœ¬; å‘½ä»¤è¡Œä»»åŠ¡ï¼šåŸç”Ÿæä¾›é€šç”¨å‘½ä»¤è¡Œä»»åŠ¡Handlerï¼ˆBeanä»»åŠ¡ï¼Œâ€CommandJobHandlerâ€ï¼‰ï¼›ä¸šåŠ¡æ–¹åªéœ€è¦æä¾›å‘½ä»¤è¡Œå³å¯ï¼› ä»»åŠ¡ä¾èµ–ï¼šæ”¯æŒé…ç½®å­ä»»åŠ¡ä¾èµ–ï¼Œå½“çˆ¶ä»»åŠ¡æ‰§è¡Œç»“æŸä¸”æ‰§è¡ŒæˆåŠŸåå°†ä¼šä¸»åŠ¨è§¦å‘ä¸€æ¬¡å­ä»»åŠ¡çš„æ‰§è¡Œ, å¤šä¸ªå­ä»»åŠ¡ç”¨é€—å·åˆ†éš”ï¼› ä¸€è‡´æ€§ï¼šâ€œè°ƒåº¦ä¸­å¿ƒâ€é€šè¿‡DBé”ä¿è¯é›†ç¾¤åˆ†å¸ƒå¼è°ƒåº¦çš„ä¸€è‡´æ€§, ä¸€æ¬¡ä»»åŠ¡è°ƒåº¦åªä¼šè§¦å‘ä¸€æ¬¡æ‰§è¡Œï¼› è‡ªå®šä¹‰ä»»åŠ¡å‚æ•°ï¼šæ”¯æŒåœ¨çº¿é…ç½®è°ƒåº¦ä»»åŠ¡å…¥å‚ï¼Œå³æ—¶ç”Ÿæ•ˆï¼› è°ƒåº¦çº¿ç¨‹æ± ï¼šè°ƒåº¦ç³»ç»Ÿå¤šçº¿ç¨‹è§¦å‘è°ƒåº¦è¿è¡Œï¼Œç¡®ä¿è°ƒåº¦ç²¾ç¡®æ‰§è¡Œï¼Œä¸è¢«å µå¡ï¼› æ•°æ®åŠ å¯†ï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨ä¹‹é—´çš„é€šè®¯è¿›è¡Œæ•°æ®åŠ å¯†ï¼Œæå‡è°ƒåº¦ä¿¡æ¯å®‰å…¨æ€§ï¼› é‚®ä»¶æŠ¥è­¦ï¼šä»»åŠ¡å¤±è´¥æ—¶æ”¯æŒé‚®ä»¶æŠ¥è­¦ï¼Œæ”¯æŒé…ç½®å¤šé‚®ä»¶åœ°å€ç¾¤å‘æŠ¥è­¦é‚®ä»¶ï¼› æ¨é€mavenä¸­å¤®ä»“åº“: å°†ä¼šæŠŠæœ€æ–°ç¨³å®šç‰ˆæ¨é€åˆ°mavenä¸­å¤®ä»“åº“, æ–¹ä¾¿ç”¨æˆ·æ¥å…¥å’Œä½¿ç”¨; è¿è¡ŒæŠ¥è¡¨ï¼šæ”¯æŒå®æ—¶æŸ¥çœ‹è¿è¡Œæ•°æ®ï¼Œå¦‚ä»»åŠ¡æ•°é‡ã€è°ƒåº¦æ¬¡æ•°ã€æ‰§è¡Œå™¨æ•°é‡ç­‰ï¼›ä»¥åŠè°ƒåº¦æŠ¥è¡¨ï¼Œå¦‚è°ƒåº¦æ—¥æœŸåˆ†å¸ƒå›¾ï¼Œè°ƒåº¦æˆåŠŸåˆ†å¸ƒå›¾ç­‰ï¼› å…¨å¼‚æ­¥ï¼šä»»åŠ¡è°ƒåº¦æµç¨‹å…¨å¼‚æ­¥åŒ–è®¾è®¡å®ç°ï¼Œå¦‚å¼‚æ­¥è°ƒåº¦ã€å¼‚æ­¥è¿è¡Œã€å¼‚æ­¥å›è°ƒç­‰ï¼Œæœ‰æ•ˆå¯¹å¯†é›†è°ƒåº¦è¿›è¡Œæµé‡å‰Šå³°ï¼Œç†è®ºä¸Šæ”¯æŒä»»æ„æ—¶é•¿ä»»åŠ¡çš„è¿è¡Œï¼› è·¨å¹³å°ï¼šåŸç”Ÿæä¾›é€šç”¨HTTPä»»åŠ¡Handlerï¼ˆBeanä»»åŠ¡ï¼Œâ€HttpJobHandlerâ€ï¼‰ï¼›ä¸šåŠ¡æ–¹åªéœ€è¦æä¾›HTTPé“¾æ¥å³å¯ï¼Œä¸é™åˆ¶è¯­è¨€ã€å¹³å°ï¼› å›½é™…åŒ–ï¼šè°ƒåº¦ä¸­å¿ƒæ”¯æŒå›½é™…åŒ–è®¾ç½®ï¼Œæä¾›ä¸­æ–‡ã€è‹±æ–‡ä¸¤ç§å¯é€‰è¯­è¨€ï¼Œé»˜è®¤ä¸ºä¸­æ–‡ï¼› å®¹å™¨åŒ–ï¼šæä¾›å®˜æ–¹dockeré•œåƒï¼Œå¹¶å®æ—¶æ›´æ–°æ¨é€dockerhubï¼Œè¿›ä¸€æ­¥å®ç°äº§å“å¼€ç®±å³ç”¨ï¼› çº¿ç¨‹æ± éš”ç¦»ï¼šè°ƒåº¦çº¿ç¨‹æ± è¿›è¡Œéš”ç¦»æ‹†åˆ†ï¼Œæ…¢ä»»åŠ¡è‡ªåŠ¨é™çº§è¿›å…¥â€Slowâ€çº¿ç¨‹æ± ï¼Œé¿å…è€—å°½è°ƒåº¦çº¿ç¨‹ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§ï¼› ç”¨æˆ·ç®¡ç†ï¼šæ”¯æŒåœ¨çº¿ç®¡ç†ç³»ç»Ÿç”¨æˆ·ï¼Œå­˜åœ¨ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ä¸¤ç§è§’è‰²ï¼› æƒé™æ§åˆ¶ï¼šæ‰§è¡Œå™¨ç»´åº¦è¿›è¡Œæƒé™æ§åˆ¶ï¼Œç®¡ç†å‘˜æ‹¥æœ‰å…¨é‡æƒé™ï¼Œæ™®é€šç”¨æˆ·éœ€è¦åˆ†é…æ‰§è¡Œå™¨æƒé™åæ‰å…è®¸ç›¸å…³æ“ä½œã€‚","categories":[{"name":"å¸¸ç”¨å·¥å…·","slug":"å¸¸ç”¨å·¥å…·","permalink":"https://github.com/weiecho/categories/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"å®šæ—¶ä»»åŠ¡","slug":"å®šæ—¶ä»»åŠ¡","permalink":"https://github.com/weiecho/tags/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/"}]},{"title":"ä¹æª¬æ¡†æ¶ä¹‹cloudå¾®æœåŠ¡æ¡†æ¶","slug":"doc_1112","date":"2019-09-06T10:34:12.000Z","updated":"2020-07-03T02:04:54.950Z","comments":true,"path":"2019/09/06/doc_1112/","link":"","permalink":"https://github.com/weiecho/2019/09/06/doc_1112/","excerpt":"","text":"åŸºäºconsulæ³¨å†Œä¸­å¿ƒå®ç°å¾®æœåŠ¡æ¡†æ¶ï¼Œä½¿ç”¨consulæ›¿ä»£eurekaå’Œgit configæ¨¡å¼ é¡¹ç›®åœ°å€ï¼šlemon-consul-cloud æœ¬é¡¹ç›®é¢„å¯åŠ¨æ—¶é—´ä¸º2019-03-01ï¼Œå®ç°ä»¥ä¸‹å†…å®¹ï¼š å¼€å‘è®¡åˆ’12345v0.1ç‰ˆæœ¬ æ•´ä½“æœåŠ¡ç»“æ„åˆ’åˆ†ï¼ŒæœåŠ¡è¾¹ç•Œè®¾å®šv0.2ç‰ˆæœ¬ æœåŠ¡ç½‘å…³æˆæƒæ¨¡å¼æ­å»ºv0.3ç‰ˆæœ¬ å‰åç«¯æŠ€æœ¯æ¡†æ¶æ¥å…¥v0.4ç‰ˆæœ¬ æœåŠ¡å¼€å‘æŠ€æœ¯è§„èŒƒæ–‡æ¡£v0.5ç‰ˆæœ¬ ç”¨æˆ·åŸºç¡€æœåŠ¡åŠŸèƒ½ æœåŠ¡æ¡†æ¶æ€»è§ˆ lemon-gateway æœåŠ¡ç½‘å…³ lemon-monitor æœåŠ¡ç›‘æ§ commons æœåŠ¡åŸºç¡€ç»„ä»¶ä¸­å¿ƒ lemon-common æœåŠ¡é€šç”¨ç»„ä»¶ lemon-distribution åˆ†å¸ƒä¸šåŠ¡é”&amp;ä»»åŠ¡é” lemon-framework æœåŠ¡åŸºç¡€åŠŸèƒ½ç±»åŒ… lemon-rabbit æœåŠ¡RabbitåŠŸèƒ½ç»Ÿä¸€å°è£…ç»„ä»¶ lemon-sharding æ•°æ®åº“åˆ†åº“åˆ†è¡¨å°è£…ç»„ä»¶ services å¾®æœåŠ¡ä¸­å¿ƒ lemon-auth æˆæƒ&amp;é‰´æƒæœåŠ¡ lemon-user ç”¨æˆ·æœåŠ¡ lemon-xxx æœåŠ¡åˆ’åˆ†è¯´æ˜æ˜ç¡®åˆ’åˆ†æ¯ä¸ªæœåŠ¡çš„åŠŸèƒ½ NO. Module Name Desc 1 lemon-auth æˆæƒæœåŠ¡ ç”¨æˆ·æˆæƒä¸­å¿ƒç®¡ç† 2 lemon-user ç”¨æˆ·æœåŠ¡ ç”¨æˆ·ä¿¡æ¯ä¸­å¿ƒæœåŠ¡ 3 lemon-payment è´¦åŠ¡æœåŠ¡ ç”¨æˆ·äº¤æ˜“ä¸­å¿ƒæœåŠ¡ 4 lemon-adjust æ ¸ç®—æœåŠ¡ è´¦æˆ·æ ¸ç®—ä¸­å¿ƒæœåŠ¡ 5 lemon-message æ¶ˆæ¯æœåŠ¡ ç”¨æˆ·æ¶ˆæ¯ä¸­å¿ƒæœåŠ¡ æœåŠ¡é¡¹ç›®ç»“æ„çº¦å®š NO. Package Desc 1 cn.lemon.{xxxx}.api.rest æä¾›å¯¹å¤–æœåŠ¡restæ¥å£ 2 cn.lemon.{xxxx}.api.rpc æä¾›å¯¹å†…æœåŠ¡rpcæ¥å£ 3 cn.lemon.{xxxx}.config æä¾›æœåŠ¡é…ç½®ç›¸å…³ 4 cn.lemon.{xxxx}.entity.enums æä¾›ä¸šåŠ¡æšä¸¾ç±» 5 cn.lemon.{xxxx}.entity.po æä¾›æ•°æ®åº“æ˜ å°„å®ä½“ 6 cn.lemon.{xxxx}.entity.vo æä¾›å¯¹å¤–æ¥å£æ˜ å°„å®ä½“ 7 cn.lemon.{xxxx}.rpc.client æä¾›å¯¹å†…æœåŠ¡rpcè°ƒç”¨æ¥å£ (apiå±‚ä¸èƒ½è°ƒç”¨rpcæ¥å£) 8 cn.lemon.{xxxx}.rpc.client.fallback æä¾›å¯¹å†…æœåŠ¡rpcè°ƒç”¨å¤±è´¥ä¸šåŠ¡å¤„ç† 9 cn.lemon.{xxxx}.service æä¾›ä¸šåŠ¡é€»è¾‘æ¥å£ (apiå±‚è°ƒç”¨ä¸šåŠ¡æ¥å£) 10 cn.lemon.{xxxx}.service.impl æä¾›ä¸šåŠ¡é€»è¾‘å®ç° 11 cn.lemon.{xxxx}.dao æä¾›æ•°æ®åº“æ“ä½œ 12 cn.lemon.{xxxx}.events.pub æä¾›MQå‘é€äº‹ä»¶ 13 cn.lemon.{xxxx}.events.sub æä¾›MQæ¥æ”¶äº‹ä»¶ 14 cn.lemon.{xxxx}.task æä¾›ä»»åŠ¡å®šæ—¶æ‰§è¡Œé€»è¾‘","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"springboot","slug":"springboot","permalink":"https://github.com/weiecho/tags/springboot/"},{"name":"cloud","slug":"cloud","permalink":"https://github.com/weiecho/tags/cloud/"},{"name":"consul","slug":"consul","permalink":"https://github.com/weiecho/tags/consul/"},{"name":"lemon","slug":"lemon","permalink":"https://github.com/weiecho/tags/lemon/"}]},{"title":"XXL-JOBåˆ†å¸ƒå¼ä»»åŠ¡å¿«é€Ÿå…¥é—¨","slug":"stu_1111","date":"2019-09-05T07:21:11.000Z","updated":"2020-07-03T02:06:28.839Z","comments":true,"path":"2019/09/05/stu_1111/","link":"","permalink":"https://github.com/weiecho/2019/09/05/stu_1111/","excerpt":"","text":"XXL-JOBæ˜¯ä¸€ä¸ªè½»é‡çº§åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç°å·²å¼€æ”¾æºä»£ç å¹¶æ¥å…¥å¤šå®¶å…¬å¸çº¿ä¸Šäº§å“çº¿ï¼Œå¼€ç®±å³ç”¨ã€‚ é¡¹ç›®åœ°å€ï¼šxxl-jobåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° æ¨¡å— è°ƒåº¦ä¸­å¿ƒ xxl-job-admin å…¬å…±ä¾èµ– xxl-job-core ä»»åŠ¡æ‰§è¡Œå™¨ opay-xxx é›†ç¾¤ è°ƒåº¦ä¸­å¿ƒé›†ç¾¤ DBé…ç½®ä¿æŒä¸€è‡´ ç™»é™†è´¦å·é…ç½®ä¿æŒä¸€è‡´ é›†ç¾¤æœºå™¨æ—¶é’Ÿä¿æŒä¸€è‡´å»ºè®®ï¼šæ¨èé€šè¿‡nginxä¸ºè°ƒåº¦ä¸­å¿ƒé›†ç¾¤åšè´Ÿè½½å‡è¡¡ï¼Œåˆ†é…åŸŸå è°ƒåº¦ä¸­å¿ƒè®¿é—®ã€æ‰§è¡Œå™¨å›è°ƒé…ç½®ã€è°ƒç”¨APIæœåŠ¡ç­‰æ“ä½œå‡é€šè¿‡è¯¥åŸŸåè¿›è¡Œã€‚ æ‰§è¡Œå™¨é›†ç¾¤ æ‰§è¡Œå™¨å›è°ƒåœ°å€ä¿æŒä¸€è‡´xxl.job.admin.addresses æ‰§è¡Œå™¨é›†ç¾¤å†…AppNameä¿æŒä¸€è‡´xxl.job.executor.appnameâ€‹ ä»»åŠ¡å…³é”®ç‚¹ æ‰§è¡Œå™¨ ä»»åŠ¡æè¿° è·¯ç”±ç­–ç•¥ FIRSTï¼ˆç¬¬ä¸€ä¸ªï¼‰å›ºå®šé€‰æ‹©ç¬¬ä¸€ä¸ªæœºå™¨ LASTï¼ˆæœ€åä¸€ä¸ªï¼‰å›ºå®šé€‰æ‹©æœ€åä¸€ä¸ªæœºå™¨ ROUNDï¼ˆè½®è¯¢ï¼‰ RANDOMï¼ˆéšæœºï¼‰éšæœºé€‰æ‹©åœ¨çº¿çš„æœºå™¨ CONSISTENT_HASHï¼ˆä¸€è‡´æ€§HASHï¼‰æ¯ä¸ªä»»åŠ¡æŒ‰ç…§Hashç®—æ³•å›ºå®šé€‰æ‹©æŸä¸€å°æœºå™¨ï¼Œä¸”æ‰€æœ‰ä»»åŠ¡å‡åŒ€æ•£åˆ—åœ¨ä¸åŒæœºå™¨ä¸Š LEAST_FREQUENTLY_USEDï¼ˆæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼‰ä½¿ç”¨é¢‘ç‡æœ€ä½çš„æœºå™¨ä¼˜å…ˆè¢«é€‰ä¸¾ LEAST_RECENTLY_USEDï¼ˆæœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ï¼‰æœ€ä¹…ä¸ºä½¿ç”¨çš„æœºå™¨ä¼˜å…ˆè¢«é€‰ä¸¾ FAILOVERï¼ˆæ•…éšœè½¬ç§»ï¼‰æŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œå¿ƒè·³æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªå¿ƒè·³æ£€æµ‹æˆåŠŸçš„æœºå™¨é€‰å®šä¸ºç›®æ ‡æ‰§è¡Œå™¨å¹¶å‘èµ·è°ƒåº¦ BUSYOVERï¼ˆå¿™ç¢Œè½¬ç§»ï¼‰æŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œç©ºé—²æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªç©ºé—²æ£€æµ‹æˆåŠŸçš„æœºå™¨é€‰å®šä¸ºç›®æ ‡æ‰§è¡Œå™¨å¹¶å‘èµ·è°ƒåº¦ SHARDING_BROADCAST(åˆ†ç‰‡å¹¿æ’­)å¹¿æ’­è§¦å‘å¯¹åº”é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼ŒåŒæ—¶ç³»ç»Ÿè‡ªåŠ¨ä¼ é€’åˆ†ç‰‡å‚æ•°ï¼Œå¯æ ¹æ®åˆ†ç‰‡å‚æ•°å¼€å‘åˆ†ç‰‡ä»»åŠ¡ Cronè¡¨è¾¾å¼ è¿è¡Œæ¨¡å¼ BEAN GLUE JobHandlerä»»åŠ¡beanåç§°@JobHandler é˜»å¡ç­–ç•¥ å•æœºä¸²è¡Œè¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œè¿›å…¥FIFOé˜Ÿåˆ—å¹¶ä»¥ä¸²è¡Œæ–¹å¼è¿è¡Œ ä¸¢å¼ƒåç»­è°ƒåº¦è¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œå‘ç°æ‰§è¡Œå™¨å­˜åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œæœ¬æ¬¡è¯·æ±‚å°†ä¼šè¢«ä¸¢å¼ƒå¹¶æ ‡è®°ä¸ºå¤±è´¥ è¦†ç›–ä¹‹å‰è°ƒåº¦è¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œå‘ç°æ‰§è¡Œå™¨å­˜åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œå°†ä¼šç»ˆæ­¢è¿è¡Œä¸­çš„è°ƒåº¦ä»»åŠ¡å¹¶æ¸…ç©ºé˜Ÿåˆ— è´Ÿè´£äºº å…¶ä»– å­ä»»åŠ¡ID è¶…æ—¶æ—¶é—´ é‡è¯•æ¬¡æ•° æŠ¥è­¦é‚®ä»¶ ä»»åŠ¡å‚æ•° æ³¨æ„äº‹é¡¹ æ—¥å¿—æ–‡ä»¶ç›®å½•éœ€è¦æƒé™é»˜è®¤ /data/applogs/xxl-job/jobhandlerâ€‹ è®¾ç½®æ—¥å¿—ä¿å­˜å¤©æ•°xxl.job.executor.logretentiondays=-1 //å¤§äº3ç”Ÿæ•ˆ æ‰§è¡Œæ—¥å¿—éœ€è¦é€šè¿‡ â€œXxlJobLogger.logâ€ æ‰“å°æ‰§è¡Œæ—¥å¿— adminæ‰§è¡Œä»»åŠ¡æ—¶æŠ¥é”™ Communications link failureæ•°æ®åº“é“¾æ¥åœ°å€åŠ ä¸Š &amp;autoReconnect=true&amp;failOverReadOnly=false","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://github.com/weiecho/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"},{"name":"å®šæ—¶ä»»åŠ¡","slug":"å®šæ—¶ä»»åŠ¡","permalink":"https://github.com/weiecho/tags/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/"}]},{"title":"æœåŠ¡å¼€å‘æ ¸å¿ƒæ€æƒ³","slug":"exp_1111","date":"2019-09-03T04:30:12.000Z","updated":"2020-07-03T02:06:50.143Z","comments":true,"path":"2019/09/03/exp_1111/","link":"","permalink":"https://github.com/weiecho/2019/09/03/exp_1111/","excerpt":"","text":"ä¿éšœæœåŠ¡å¯æ‰©å±•æ€§çš„ä¸ƒå¤§åŸåˆ™1ã€æŒ‰åŠŸèƒ½åˆ’åˆ† 2ã€æ°´å¹³åˆ‡åˆ† 3ã€å°½é‡é¿å…äº‹åŠ¡ 4ã€é€‚å½“é‡‡ç”¨å¼‚æ­¥è§£è€¦ 5ã€æ¬¡æµç¨‹æ”¹è¿›ä¸ºå¼‚æ­¥ 6ã€è™šæ‹ŸåŒ–æ‰€æœ‰å±‚æ¬¡ 7ã€é€‚å½“ä½¿ç”¨ç¼“å­˜ æœåŠ¡æ‹†åˆ†å¼€å‘çš„å››é¡¹åŸåˆ™1ã€å…ˆä¸šåŠ¡åæŠ€æœ¯ï¼Œå…ˆé€»è¾‘åç‰©ç† 2ã€å¥¥å¡å§†å‰ƒåˆ€ï¼šå¦‚æ— å¿…é¡»å‹¿å¢å®ä½“ 3ã€æ­£äº¤æ€§ï¼šæŠ½è±¡å‡ºæ¨¡å—é—´æ— ä¸šåŠ¡ç›¸å…³çš„é‡å¤ä»£ç  4ã€ç¨³å®šæ€§åŸåˆ™ï¼šæœåŠ¡çš„ç¨³å®šæ€§ä¼˜å…ˆï¼Œé€šè¿‡æ‹†åˆ†è§£è€¦ å¯å‚è€ƒçš„æŠ€æœ¯æ–¹æ¡ˆï¼šæ¥å£åŒ–ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æ¨¡å—åŒ–ã€æœåŠ¡åŒ–ã€å¼‚æ­¥åŒ–","categories":[{"name":"ç»éªŒåˆ†äº«","slug":"ç»éªŒåˆ†äº«","permalink":"https://github.com/weiecho/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"springboot","slug":"springboot","permalink":"https://github.com/weiecho/tags/springboot/"},{"name":"cloud","slug":"cloud","permalink":"https://github.com/weiecho/tags/cloud/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://github.com/weiecho/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"}]},{"title":"Hutoolå·¥å…·åŒ…ç±»åº“","slug":"tool_1111","date":"2019-09-02T12:33:12.000Z","updated":"2020-07-03T02:06:37.677Z","comments":true,"path":"2019/09/02/tool_1111/","link":"","permalink":"https://github.com/weiecho/2019/09/02/tool_1111/","excerpt":"","text":"Hutoolæ˜¯ä¸€ä¸ªJavaå·¥å…·åŒ…ï¼Œä¹Ÿåªæ˜¯ä¸€ä¸ªå·¥å…·åŒ…ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¯ä¸€è¡Œä»£ç ï¼Œå‡å°‘æ¯ä¸€ä¸ªæ–¹æ³•ï¼Œè®©Javaè¯­è¨€ä¹Ÿå¯ä»¥â€œç”œç”œçš„â€ã€‚Hutoolæœ€åˆæ˜¯æˆ‘é¡¹ç›®ä¸­â€œutilâ€åŒ…çš„ä¸€ä¸ªæ•´ç†ï¼Œåæ¥æ…¢æ…¢ç§¯ç´¯å¹¶åŠ å…¥æ›´å¤šéä¸šåŠ¡ç›¸å…³åŠŸèƒ½ï¼Œå¹¶å¹¿æ³›å­¦ä¹ å…¶å®ƒå¼€æºé¡¹ç›®ç²¾é«“ï¼Œç»è¿‡è‡ªå·±æ•´ç†ä¿®æ”¹ï¼Œæœ€ç»ˆå½¢æˆä¸°å¯Œçš„å¼€æºå·¥å…·é›†ã€‚ é¡¹ç›®åœ°å€ï¼šhutoolå·¥å…·åŒ… æ—¥æœŸå·¥å…·é€šè¿‡DateUtilç±»ï¼Œæä¾›é«˜åº¦ä¾¿æ·çš„æ—¥æœŸè®¿é—®ã€å¤„ç†å’Œè½¬æ¢æ–¹å¼ã€‚ HTTPå®¢æˆ·ç«¯é€šè¿‡HttpUtilå¯¹HTTPå®¢æˆ·ç«¯çš„å°è£…ï¼Œå®ç°ä¾¿æ·çš„HTTPè¯·æ±‚ï¼Œå¹¶ç®€åŒ–æ–‡ä»¶ä¸Šä¼ æ“ä½œã€‚ è½¬æ¢å·¥å…·é€šè¿‡Convertç±»ä¸­çš„ç›¸åº”é™æ€æ–¹æ³•ï¼Œæä¾›ä¸€æ•´å¥—çš„ç±»å‹è½¬æ¢è§£å†³æ–¹æ¡ˆï¼Œå¹¶é€šè¿‡ConverterRegistryå·¥å‚ç±»è‡ªå®šä¹‰è½¬æ¢ã€‚ é…ç½®æ–‡ä»¶å·¥å…·é€šè¿‡Settingå¯¹è±¡ï¼Œæä¾›å…¼å®¹Propertiesæ–‡ä»¶çš„æ›´åŠ å¼ºå¤§çš„é…ç½®æ–‡ä»¶å·¥å…·ï¼Œç”¨äºè§£å†³ä¸­æ–‡ã€åˆ†ç»„ç­‰JDKé…ç½®æ–‡ä»¶å­˜åœ¨çš„è¯¸å¤šé—®é¢˜ã€‚ æ—¥å¿—å·¥å…·Hutoolçš„æ—¥å¿—åŠŸèƒ½ï¼Œé€šè¿‡æŠ½è±¡Logæ¥å£ï¼Œæä¾›å¯¹Slf4jã€LogBackã€Log4jã€JDK-Loggingçš„å…¨é¢å…¼å®¹æ”¯æŒã€‚ JDBCå·¥å…·ç±»é€šè¿‡dbæ¨¡å—ï¼Œæä¾›å¯¹MySQLã€Oracleç­‰å…³ç³»å‹æ•°æ®åº“çš„JDBCå°è£…ï¼Œå€ŸåŠ©ActiveRecordæ€æƒ³ï¼Œå¤§å¤§ç®€åŒ–æ•°æ®åº“æ“ä½œã€‚","categories":[{"name":"å¸¸ç”¨å·¥å…·","slug":"å¸¸ç”¨å·¥å…·","permalink":"https://github.com/weiecho/categories/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"},{"name":"spring","slug":"spring","permalink":"https://github.com/weiecho/tags/spring/"},{"name":"å¼€æºå·¥å…·","slug":"å¼€æºå·¥å…·","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"}]},{"title":"å¼€å‘è€…çº¦å®š","slug":"doc_1110","date":"2019-09-01T03:10:12.000Z","updated":"2020-07-08T03:28:05.939Z","comments":true,"path":"2019/09/01/doc_1110/","link":"","permalink":"https://github.com/weiecho/2019/09/01/doc_1110/","excerpt":"","text":"æœ¬æ–‡æ¡£çº¦å®šäº†æœåŠ¡å¼€å‘äººå‘˜çš„ä»£ç è§„èŒƒï¼Œä»è€Œå¢å¼ºä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ 1ã€æ¥å£åœ°å€å’Œå‚æ•°ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œæ¥å£å°½é‡å…¨éƒ¨å°å†™ï¼Œå‚æ•°ä½¿ç”¨é©¼å³°å‘½åï¼› 2ã€æ¥å£é»˜è®¤ä»¥è¯·æ±‚å‚æ•°å½¢å¼ä¼ å…¥å‚æ•°ï¼Œå“åº”è¿”å›JSONæ ¼å¼æ•°æ®ï¼› 3ã€H5å†…æ‰€æœ‰èµ„æºå¼•ç”¨æ‰“åŒ…è‡ªåŠ¨å¸¦ä¸Šæ—¥æœŸç‰ˆæœ¬å·ï¼Œé˜²æ­¢å‘å¸ƒç‰ˆæœ¬å¼•ç”¨èµ„æºåœ¨æµè§ˆå™¨ç¼“å­˜å¯¼è‡´åŠŸèƒ½å¼‚å¸¸ï¼ˆå¦‚ï¼š./jquery-1.11.0.js?v=201806051011ï¼‰ 4ã€æ¥å£è¯·æ±‚æ•°æ®å‡éœ€è¦æºå¸¦headerå‚æ•°ï¼š å‚æ•°å å¿…å¡« ç±»å‹ è¯´æ˜ x-auth-scope æ˜¯ string æˆæƒä½œç”¨åŸŸ x-auth-token æ˜¯ string æˆæƒçš„token x-app-version æ˜¯ string åº”ç”¨ç‰ˆæœ¬ï¼ˆå›ºå®š 1.0.0ï¼‰ x-device æ˜¯ integer è®¾å¤‡ç±»å‹(1ï¼šIOS 2ï¼šAndroid 3ï¼šwap 4: å¾®ä¿¡ 5: H5) x-device-name æ˜¯ string è®¾å¤‡/æµè§ˆå™¨åç§°ï¼ˆå¦‚ï¼šhuawei/Chromeï¼‰ x-timestamp æ˜¯ long 10ä½æ—¶é—´æˆ³ 5ã€æ¥å£è¿”å›æ•°æ®JSONæ ¼å¼æ ‡å‡†: æ­£å¸¸çŠ¶å†µä¸‹è¿”å›httpçŠ¶æ€ç ä¸º200 å¼‚å¸¸æˆ–ç›¸å…³æç¤ºæ˜¯httpçŠ¶æ€ç å¤§äºç­‰äº400 ä¸šåŠ¡å¼‚å¸¸æ—¶httpçŠ¶æ€ç ä¸º400ï¼Œç³»ç»Ÿæ•…éšœæ—¶httpçŠ¶æ€ç ä¸º500 æ­£å¸¸çŠ¶å†µä¸‹æ¥å£ç›´æ¥è¿”å›ä¸šåŠ¡æ•°æ®ï¼ˆvoidæ—¶è¿”å›ç©ºï¼‰ å¼‚å¸¸æ—¶è¿”å›é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰ å‚æ•°å ç±»å‹ è¯´æ˜ code integer é”™è¯¯ç  msg string é”™è¯¯ä¿¡æ¯ å¸¦è¿”å›æ•°æ®ç¤ºä¾‹ï¼š 12345&#123; \"userId\": \"1488512189\", \"nickName\": \"å“ˆå“ˆ\", \"vip\": \"12\"&#125; å¼‚å¸¸è¿”å›ç¤ºä¾‹ï¼š 1234&#123; \"msg\": \"çŸ­ä¿¡éªŒè¯ç å‘é€å¤±è´¥\", \"code\": \"13007\"&#125;","categories":[{"name":"å¼€æºæ–‡æ¡£","slug":"å¼€æºæ–‡æ¡£","permalink":"https://github.com/weiecho/categories/%E5%BC%80%E6%BA%90%E6%96%87%E6%A1%A3/"}],"tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://github.com/weiecho/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"å¼€å‘è§„èŒƒ","slug":"å¼€å‘è§„èŒƒ","permalink":"https://github.com/weiecho/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"},{"name":"java","slug":"java","permalink":"https://github.com/weiecho/tags/java/"}]}]}